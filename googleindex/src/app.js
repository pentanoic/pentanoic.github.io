// Redesigned by telegram.dog/TheFirstSpeedster at https://www.npmjs.com/package/@googledrive/index which was written by someone else, credits are given on Source Page.
// v2.3.7

// ============================================================================
// FILE TYPE CONSTANTS - Centralized file extension mappings
// ============================================================================
const FILE_TYPES = {
    video: ['mp4', 'webm', 'avi', 'mpg', 'mpeg', 'mkv', 'rm', 'rmvb', 'mov', 'wmv', 'asf', 'ts', 'flv', '3gp', 'm4v'],
    audio: ['mp3', 'flac', 'wav', 'ogg', 'm4a', 'aac', 'wma', 'alac'],
    image: ['bmp', 'jpg', 'jpeg', 'png', 'gif', 'svg', 'tiff', 'ico'],
    code: ['php', 'css', 'go', 'java', 'js', 'json', 'txt', 'sh', 'md', 'html', 'xml', 'py', 'rb', 'c', 'cpp', 'h', 'hpp'],
    archive: ['zip', 'rar', 'tar', '7z', 'gz'],
    document: ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'],
    markdown: ['md']
};

// ============================================================================
// HELPER FUNCTIONS - Reusable utilities
// ============================================================================

/**
 * Check if a file extension belongs to a specific type
 * @param {string} ext - File extension
 * @param {string} type - Type name from FILE_TYPES
 * @returns {boolean}
 */
function isFileType(ext, type) {
    return FILE_TYPES[type] && FILE_TYPES[type].includes(ext?.toLowerCase());
}

/**
 * Get the icon for a file based on its extension
 * @param {string} ext - File extension
 * @returns {string} - SVG icon HTML
 */
function getFileIcon(ext) {
    const extLower = ext?.toLowerCase?.() || '';
    const iconMap = {
        //'dwg': dwg_icon,
        //'dxf': dwg_icon,
        'pdf': pdf_icon,
    };
    // Kiểm tra nhóm trước
    if (isFileType(extLower, 'video'))    return video_icon;
    if (isFileType(extLower, 'audio'))    return audio_icon;
    if (isFileType(extLower, 'image'))    return image_icon;
    if (isFileType(extLower, 'code'))     return code_icon;
    if (isFileType(extLower, 'archive'))  return zip_icon;
    if (isFileType(extLower, 'markdown')) return markdown_icon;
    // Lấy từ map nếu có, không thì mặc định
    return iconMap[extLower] || file_icon;
}

/**
 * Generate breadcrumb navigation HTML for file views
 * @param {string} path - Current URL path
 * @param {boolean} isViewPage - Whether this is a file view page
 * @returns {string} - HTML for breadcrumb navigation
 */
function generateBreadcrumb(path, isViewPage = true) {
    const pathParts = path.split('/');
    let navigation = '';
    let newPath = '';

    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (isViewPage && i === pathParts.length - 1) {
            newPath += part + '?a=view';
        } else {
            newPath += part + '/';
        }

        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }

        if (part === '') {
            part = 'Home';
        }

        navigation += '<a href="' + newPath + '" class="breadcrumb-item">' + part + '</a>';
    }

    return navigation;
}

/**
 * Generate download button dropdown with various app integrations
 * @param {string} url - Download URL
 * @param {string} encodedName - URL-encoded filename
 * @param {boolean} isVideo - Whether this is a video file
 * @returns {string} - HTML for dropdown menu
 */
function generateDownloadDropdown(url, encodedName, isVideo = false) {
    let dropdown = '';

    if (isVideo) {
        dropdown += `
            <a class="dropdown-item" href="iina://weblink?url=${url}">IINA</a>
            <a class="dropdown-item" href="potplayer://${url}">PotPlayer</a>
            <a class="dropdown-item" href="vlc://${url}">VLC Mobile</a>
            <a class="dropdown-item" href="${url}">VLC Desktop</a>
            <a class="dropdown-item" href="nplayer-${url}">nPlayer</a>
            <a class="dropdown-item" href="intent://${url}#Intent;type=video/any;package=is.xyz.mpv;scheme=https;end;">mpv-android</a>
            <a class="dropdown-item" href="mpv://${btoa(url)}">mpv x64</a>
            <a class="dropdown-item" href="intent:${url}#Intent;package=com.mxtech.videoplayer.ad;S.title=${encodedName};end">MX Player (Free)</a>
            <a class="dropdown-item" href="intent:${url}#Intent;package=com.mxtech.videoplayer.pro;S.title=${encodedName};end">MX Player (Pro)</a>`;
    }

    dropdown += `
        <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encodedName};end">1DM (Free)</a>
        <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encodedName};end">1DM (Lite)</a>
        <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encodedName};end">1DM+ (Plus)</a>`;

    return dropdown;
}

/**
 * Create a standard file view container with card layout
 * @param {Object} options - Configuration object
 * @returns {string} - HTML content
 */
function createFileViewContainer(options) {
    const { name, size, url, encodedName, navigation, bodyContent = '', isVideo = false, showDownload = true } = options;

    const downloadSection = showDownload ? `
        <div class="card-body">
            <div class="input-group mb-4">
                <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
            </div>
            <div class="card-text text-center">
                <div class="btn-group text-center">
                    <a href="${url}" type="button" class="btn btn-primary">Download</a>
                    <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="sr-only"></span>
                    </button>
                    <div class="dropdown-menu">
                        ${generateDownloadDropdown(url, encodedName, isVideo)}
                    </div>
                </div>
            </div>
            <br>
        </div>` : '';

    return `
        <div class="container text-center"><br>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">${navigation}</ol>
            </nav>
            <div class="card text-center">
                <div class="card-body text-center">
                    <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>
                </div>
                ${bodyContent}
                ${downloadSection}
            </div>
        </div>`;
}

// ============================================================================
// MAIN APPLICATION CODE
// ============================================================================

// Initialize the page
function init() {
    document.siteName = $('title').html();
    const html = `<header>
   <div id="nav">
   </div>
</header>
<div class="loading" id="spinner" style="display:none;">Loading&#8230;</div>
<div>
<div id="content" style="padding-top: ${UI.header_padding}px;${UI.fixed_footer ?' padding-bottom: clamp(170px, 100%, 300px);': ''}">
</div>
<div class="modal fade" id="SearchModel" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="SearchModelLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="SearchModelLabel"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true"></span>
        </button>
      </div>
      <div class="modal-body" id="modal-body-space">
      </div>
      <div class="modal-footer" id="modal-body-space-buttons">
      </div>
    </div>
  </div>
</div>
<br>
<footer class="footer mt-auto py-3 text-muted ${UI.footer_style_class}" style="${UI.fixed_footer ?'position: fixed; ': ''}left: 0; bottom: 0; width: 100%; color: white; z-index: 9999;${UI.hide_footer ? ' display:none;': ' display:block;'}"> <div class="container" style="width: auto; padding: 0 10px;"> <p class="float-end"> <a href="#">Back to top</a> </p> ${UI.credit ? '<p>Redesigned with <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-heart-fill" fill="red" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z" /> </svg> by <a href="https://www.npmjs.com/package/@googledrive/index" target="_blank">TheFirstSpeedster</a>, based on Open Source Softwares.</p>' : ''} <p>© ${UI.copyright_year} - <a href=" ${UI.company_link}" target="_blank"> ${UI.company_name}</a>, All Rights Reserved.</p> </div> </footer>
  `;
    $('body').html(html);
}

const folder_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_11)"><g transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,24,24)"><path fill="rgb(255,159,0)" fill-opacity="1" d=" M16,-12 C16,-12 -2,-12 -2,-12 C-2,-12 -6,-16 -6,-16 C-6,-16 -16,-16 -16,-16 C-18.200000762939453,-16 -20,-14.199999809265137 -20,-12 C-20,-12 -20,12 -20,12 C-20,14.208999633789062 -18.208999633789062,16 -16,16 C-16,16 13.682000160217285,16 13.682000160217285,16 C13.682000160217285,16 20,5 20,5 C20,5 20,-8 20,-8 C20,-10.199999809265137 18.200000762939453,-12 16,-12z"></path></g></g><g transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,24,26)"><path fill="rgb(255,201,40)" fill-opacity="1" d=" M16,-14 C16,-14 -16,-14 -16,-14 C-18.200000762939453,-14 -20,-12.199999809265137 -20,-10 C-20,-10 -20,10 -20,10 C-20,12.199999809265137 -18.200000762939453,14 -16,14 C-16,14 16,14 16,14 C18.200000762939453,14 20,12.199999809265137 20,10 C20,10 20,-10 20,-10 C20,-12.199999809265137 18.200000762939453,-14 16,-14z"></path></g></g></g></svg>`;
const video_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_11)"><g transform="matrix(1,0,0,1,24,24)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(63,81,181)" fill-opacity="1" d=" M16,17 C16,17 -16,17 -16,17 C-18.200000762939453,17 -20,15.199999809265137 -20,13 C-20,13 -20,-9 -20,-9 C-20,-9 20,-9 20,-9 C20,-9 20,13 20,13 C20,15.199999809265137 18.200000762939453,17 16,17z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M16,-9 C16,-9 12,-3 12,-3 C12,-3 16,-3 16,-3 C16,-3 20,-9 20,-9 C20,-9 16,-9 16,-9z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M8,-9 C8,-9 4,-3 4,-3 C4,-3 8,-3 8,-3 C8,-3 12,-9 12,-9 C12,-9 8,-9 8,-9z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M0,-9 C0,-9 -4,-3 -4,-3 C-4,-3 0,-3 0,-3 C0,-3 4,-9 4,-9 C4,-9 0,-9 0,-9z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M-8,-9 C-8,-9 -12,-3 -12,-3 C-12,-3 -8,-3 -8,-3 C-8,-3 -4,-9 -4,-9 C-4,-9 -8,-9 -8,-9z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M-16,-9 C-16,-9 -20,-3 -20,-3 C-20,-3 -16,-3 -16,-3 C-16,-3 -12,-9 -12,-9 C-12,-9 -16,-9 -16,-9z"></path></g></g></g><g transform="matrix(1,0,0,1,24,24)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(63,81,181)" fill-opacity="1" d=" M19.399999618530273,-15.699999809265137 C19.399999618530273,-15.699999809265137 -20,-9 -20,-9 C-20,-9 -20.299999237060547,-11 -20.299999237060547,-11 C-20.700000762939453,-13.199999809265137 -19.200000762939453,-15.199999809265137 -17,-15.600000381469727 C-17,-15.600000381469727 14.600000381469727,-20.899999618530273 14.600000381469727,-20.899999618530273 C16.799999237060547,-21.299999237060547 18.799999237060547,-19.799999237060547 19.200000762939453,-17.600000381469727 C19.200000762939453,-17.600000381469727 19.399999618530273,-15.699999809265137 19.399999618530273,-15.699999809265137z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M-5.199999809265137,-17.600000381469727 C-5.199999809265137,-17.600000381469727 -0.30000001192092896,-12.300000190734863 -0.30000001192092896,-12.300000190734863 C-0.30000001192092896,-12.300000190734863 3.700000047683716,-13 3.700000047683716,-13 C3.700000047683716,-13 -1.2999999523162842,-18.299999237060547 -1.2999999523162842,-18.299999237060547 C-1.2999999523162842,-18.299999237060547 -5.199999809265137,-17.600000381469727 -5.199999809265137,-17.600000381469727z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M-13.100000381469727,-16.299999237060547 C-13.100000381469727,-16.299999237060547 -8.199999809265137,-11 -8.199999809265137,-11 C-8.199999809265137,-11 -4.199999809265137,-11.699999809265137 -4.199999809265137,-11.699999809265137 C-4.199999809265137,-11.699999809265137 -9.199999809265137,-16.899999618530273 -9.199999809265137,-16.899999618530273 C-9.199999809265137,-16.899999618530273 -13.100000381469727,-16.299999237060547 -13.100000381469727,-16.299999237060547z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M2.700000047683716,-18.899999618530273 C2.700000047683716,-18.899999618530273 7.599999904632568,-13.699999809265137 7.599999904632568,-13.699999809265137 C7.599999904632568,-13.699999809265137 11.5,-14.300000190734863 11.5,-14.300000190734863 C11.5,-14.300000190734863 6.599999904632568,-19.600000381469727 6.599999904632568,-19.600000381469727 C6.599999904632568,-19.600000381469727 2.700000047683716,-18.899999618530273 2.700000047683716,-18.899999618530273z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M10.5,-20.200000762939453 C10.5,-20.200000762939453 15.5,-15 15.5,-15 C15.5,-15 19.399999618530273,-15.699999809265137 19.399999618530273,-15.699999809265137 C19.399999618530273,-15.699999809265137 14.5,-20.899999618530273 14.5,-20.899999618530273 C14.5,-20.899999618530273 10.5,-20.200000762939453 10.5,-20.200000762939453z"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(159,168,218)" fill-opacity="1" d=" M-16.5,-14 C-17.327999114990234,-14 -18,-13.32800006866455 -18,-12.5 C-18,-11.67199993133545 -17.327999114990234,-11 -16.5,-11 C-15.67199993133545,-11 -15,-11.67199993133545 -15,-12.5 C-15,-13.32800006866455 -15.67199993133545,-14 -16.5,-14z"></path></g></g></g></svg>`;
const code_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_2)"><g transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,24,21)"><path fill="rgb(83,109,121)" fill-opacity="1" d=" M-18,-13 C-18,-13 18,-13 18,-13 C18,-13 18,13 18,13 C18,13 -18,13 -18,13 C-18,13 -18,-13 -18,-13z"></path></g><g opacity="1" transform="matrix(1,0,0,1,24,20.5)"><path fill="rgb(186,222,250)" fill-opacity="1" d=" M-16,-10.5 C-16,-10.5 16,-10.5 16,-10.5 C16,-10.5 16,10.5 16,10.5 C16,10.5 -16,10.5 -16,10.5 C-16,10.5 -16,-10.5 -16,-10.5z"></path></g><g opacity="1" transform="matrix(1,0,0,1,24,37)"><path fill="rgb(69,90,99)" fill-opacity="1" d=" M-3,-3 C-3,-3 3,-3 3,-3 C3,-3 3,0 3,0 C3,0 -3,0 -3,0 C-3,0 -3,-3 -3,-3z M9,0 C9,0 -9,0 -9,0 C-11,0 -11,2 -11,2 C-11,2 -11,3 -11,3 C-11,3 11,3 11,3 C11,3 11,2 11,2 C11,2 11,0 9,0z"></path></g></g><g transform="matrix(0.8999999761581421,0,0,0.8999999761581421,2.2750015258789062,-1.0999984741210938)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,15.315999984741211,24.465999603271484)"><path fill="rgb(21,101,192)" fill-opacity="1" d=" M-0.8989999890327454,0.02500000037252903 C-0.8989999890327454,0.02500000037252903 3.684000015258789,2.0399999618530273 3.684000015258789,2.0399999618530273 C3.684000015258789,2.0399999618530273 3.684000015258789,4.894999980926514 3.684000015258789,4.894999980926514 C3.684000015258789,4.894999980926514 -3.684000015258789,1.2100000381469727 -3.684000015258789,1.2100000381469727 C-3.684000015258789,1.2100000381469727 -3.684000015258789,-1.1990000009536743 -3.684000015258789,-1.1990000009536743 C-3.684000015258789,-1.1990000009536743 3.684000015258789,-4.894999980926514 3.684000015258789,-4.894999980926514 C3.684000015258789,-4.894999980926514 3.684000015258789,-2.0399999618530273 3.684000015258789,-2.0399999618530273 C3.684000015258789,-2.0399999618530273 -0.8989999890327454,0.02500000037252903 -0.8989999890327454,0.02500000037252903z"></path></g><g opacity="1" transform="matrix(-1,0,0,-1,32.70000076293945,24.465999603271484)"><path fill="rgb(21,101,192)" fill-opacity="1" d=" M-0.8989999890327454,0.02500000037252903 C-0.8989999890327454,0.02500000037252903 3.684000015258789,2.0399999618530273 3.684000015258789,2.0399999618530273 C3.684000015258789,2.0399999618530273 3.684000015258789,4.894999980926514 3.684000015258789,4.894999980926514 C3.684000015258789,4.894999980926514 -3.684000015258789,1.2100000381469727 -3.684000015258789,1.2100000381469727 C-3.684000015258789,1.2100000381469727 -3.684000015258789,-1.1990000009536743 -3.684000015258789,-1.1990000009536743 C-3.684000015258789,-1.1990000009536743 3.684000015258789,-4.894999980926514 3.684000015258789,-4.894999980926514 C3.684000015258789,-4.894999980926514 3.684000015258789,-2.0399999618530273 3.684000015258789,-2.0399999618530273 C3.684000015258789,-2.0399999618530273 -0.8989999890327454,0.02500000037252903 -0.8989999890327454,0.02500000037252903z"></path></g><g opacity="1" transform="matrix(1,0,0,1,24.240999221801758,24)"><path fill="rgb(21,101,192)" fill-opacity="1" d=" M-1.1649999618530273,7.986000061035156 C-1.1649999618530273,7.986000061035156 -3.259000062942505,7.986000061035156 -3.259000062942505,7.986000061035156 C-3.259000062942505,7.986000061035156 1.1619999408721924,-7.916999816894531 1.1619999408721924,-7.916999816894531 C1.1619999408721924,-7.916999816894531 3.259000062942505,-7.916999816894531 3.259000062942505,-7.916999816894531 C3.259000062942505,-7.916999816894531 -1.1649999618530273,7.986000061035156 -1.1649999618530273,7.986000061035156z"></path></g></g></g></svg>`;
const zip_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 32 32"><g transform="translate(0 -1020.362)"><path fill="#e9eded" fill-rule="evenodd" stroke="#4bbfeb" stroke-linecap="round" stroke-linejoin="round" d="m 26.49822,1027.8658 0,21.5 c 0,0.831 -0.66899,1.5 -1.49998,1.5 l -18.00004,0 c -0.83099,0 -1.49998,-0.669 -1.49998,-1.5 l 0,-26 c 0,-0.831 0.66899,-1.5 1.49998,-1.5 l 13.50002,0 z"/><path fill="#4bbfeb" d="m 4.99822,1044.3658 0,2 0,2 0,1 c 0,1.108 0.89198,2 2,2 l 18,0 c 1.10802,0 2,-0.892 2,-2 l 0,-1 0,-2 0,-2 -2,0 -18,0 -2,0 z"/><path fill="#4bbfeb" stroke="#4bbfeb" stroke-linecap="round" stroke-linejoin="round" d="m 26.49466,1027.8658 -4.49997,0 c -0.83099,0 -1.49998,-0.6691 -1.49998,-1.5 l 0,-4.5"/><path style="line-height:normal;text-indent:0;text-align:start;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000;text-transform:none;block-progression:tb;isolation:auto;mix-blend-mode:normal" fill="#4bbfeb" fill-rule="evenodd" d="M 15.498047 7 L 15.498047 8 L 14.498047 8 L 14.498047 9 L 15.498047 9 L 15.498047 10 L 14.498047 10 L 14.498047 11 L 15.498047 11 L 15.498047 12 L 14.498047 12 L 14.498047 13 L 15.498047 13 L 15.498047 14 L 14.498047 14 L 14.498047 15 L 15.498047 15 L 15.498047 16 L 14.498047 16 L 14.498047 17 L 15.498047 17 L 15.498047 18 L 14.998047 18 A 0.50004997 0.50004997 0 0 0 14.498047 18.5 L 14.498047 19.464844 A 0.50004997 0.50004997 0 0 0 14.498047 19.5 L 14.498047 20 L 14.498047 20.5 C 14.498047 21.3224 15.175696 22 15.998047 22 C 16.820398 22 17.498047 21.3224 17.498047 20.5 L 17.498047 20.033203 A 0.50004997 0.50004997 0 0 0 17.498047 20 L 17.498047 19.5 L 17.498047 18.5 A 0.50004997 0.50004997 0 0 0 16.998047 18 L 16.498047 18 L 16.498047 17 L 17.498047 17 L 17.498047 16 L 16.498047 16 L 16.498047 15 L 17.498047 15 L 17.498047 14 L 16.498047 14 L 16.498047 13 L 17.498047 13 L 17.498047 12 L 16.498047 12 L 16.498047 11 L 17.498047 11 L 17.498047 10 L 16.498047 10 L 16.498047 9 L 17.498047 9 L 17.498047 8 L 16.498047 8 L 16.498047 7 L 15.498047 7 z M 15.498047 19 L 16.498047 19 L 16.498047 19.5 L 16.498047 20.5 C 16.498047 20.7857 16.283696 21 15.998047 21 C 15.712398 21 15.498047 20.7857 15.498047 20.5 L 15.498047 20.033203 A 0.50004997 0.50004997 0 0 0 15.498047 20 L 15.498047 19.5 L 15.498047 19 z " color="#000" font-family="sans-serif" font-weight="400" overflow="visible" transform="translate(0 1020.362)"/><path style="line-height:normal;text-indent:0;text-align:start;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000;text-transform:none;block-progression:tb;isolation:auto;mix-blend-mode:normal" fill="#e9eded" fill-rule="evenodd" d="M 13.490234 24.990234 A 0.50005 0.50005 0 0 0 12.998047 25.496094 L 12.998047 29.498047 A 0.50005 0.50005 0 1 0 13.998047 29.498047 L 13.998047 25.496094 A 0.50005 0.50005 0 0 0 13.490234 24.990234 z M 11.511719 24.998047 A 0.50005 0.50005 0 0 0 11.460938 25 L 8.5058594 25 A 0.50005 0.50005 0 1 0 8.5058594 26 L 10.498047 26 L 8.1347656 29.154297 A 0.50005 0.50005 0 0 0 8.4375 29.992188 A 0.50019268 0.50019268 0 0 0 8.4472656 29.994141 A 0.50005 0.50005 0 0 0 8.5058594 29.998047 L 11.494141 29.998047 A 0.50005 0.50005 0 1 0 11.494141 28.998047 L 9.5019531 28.998047 L 11.865234 25.841797 A 0.50005 0.50005 0 0 0 11.75 25.066406 A 0.50005 0.50005 0 0 0 11.720703 25.050781 A 0.50005 0.50005 0 0 0 11.705078 25.042969 A 0.50005 0.50005 0 0 0 11.675781 25.03125 A 0.50005 0.50005 0 0 0 11.658203 25.025391 A 0.50005 0.50005 0 0 0 11.511719 24.998047 z M 16.498047 25.003906 C 15.723646 25.003906 15.086569 25.606569 15.013672 26.363281 C 15.013355 26.366575 15.012014 26.369747 15.011719 26.373047 A 0.50005 0.50005 0 0 0 14.998047 26.498047 C 14.998039 26.500027 14.998047 26.501925 14.998047 26.503906 L 14.998047 29.498047 A 0.50005 0.50005 0 1 0 15.998047 29.498047 L 15.998047 27.910156 C 16.155295 27.966775 16.322382 28.003906 16.498047 28.003906 C 17.320552 28.003906 17.998047 27.326406 17.998047 26.503906 C 17.998047 25.681406 17.320552 25.003906 16.498047 25.003906 z M 16.498047 26.003906 C 16.780112 26.003906 16.998047 26.221906 16.998047 26.503906 C 16.998047 26.786006 16.780112 27.003906 16.498047 27.003906 C 16.215982 27.003906 15.998047 26.786006 15.998047 26.503906 L 15.998047 26.498047 C 16.001131 26.218978 16.217997 26.003906 16.498047 26.003906 z " color="#000" font-family="sans-serif" font-weight="400" overflow="visible" transform="translate(0 1020.362)"/></g></svg>`;
const image_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_19)"><g transform="matrix(1,0,0,1,24,24)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(245,124,0)" fill-opacity="1" d=" M16,17 C16,17 -16,17 -16,17 C-18.200000762939453,17 -20,15.199999809265137 -20,13 C-20,13 -20,-13 -20,-13 C-20,-15.199999809265137 -18.200000762939453,-17 -16,-17 C-16,-17 16,-17 16,-17 C18.200000762939453,-17 20,-15.199999809265137 20,-13 C20,-13 20,13 20,13 C20,15.199999809265137 18.200000762939453,17 16,17z"></path></g></g><g transform="matrix(1,0,0,1,35,16)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(255,249,196)" fill-opacity="1" d=" M0,-3 C-1.656999945640564,-3 -3,-1.656999945640564 -3,0 C-3,1.656999945640564 -1.656999945640564,3 0,3 C1.656999945640564,3 3,1.656999945640564 3,0 C3,-1.656999945640564 1.656999945640564,-3 0,-3z"></path></g></g><g transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,20,24)"><path fill="rgb(148,42,9)" fill-opacity="1" d=" M0,-8 C0,-8 -11,8 -11,8 C-11,8 11,8 11,8 C11,8 0,-8 0,-8z"></path></g><g opacity="1" transform="matrix(1,0,0,1,31,27)"><path fill="rgb(191,54,12)" fill-opacity="1" d=" M0,-5 C0,-5 -8,5 -8,5 C-8,5 8,5 8,5 C8,5 0,-5 0,-5z"></path></g></g></g></svg>`;
const audio_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_30)"><g mask="url(#__lottie_element_41)" transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,26,24)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(129,211,249)" stroke-opacity="1" stroke-width="2" d=" M-16,0 C-16,-8.836000442504883 -8.836000442504883,-16 0,-16 C0.6779999732971191,-16 1.3450000286102295,-15.958000183105469 2,-15.87600040435791 C9.892999649047852,-14.892000198364258 16,-8.159000396728516 16,0 C16,8.159000396728516 9.892999649047852,14.892000198364258 2,15.87600040435791 C1.3450000286102295,15.958000183105469 0.6779999732971191,16 0,16 C-8.836000442504883,16 -16,8.836999893188477 -16,0z"></path></g></g><g mask="url(#__lottie_element_38)" style="display: none;" transform="matrix(1,0,0,1,0,0)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,26,24)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(129,211,249)" stroke-opacity="1" stroke-width="2" d=" M-16,0 C-16,-8.836000442504883 -8.836000442504883,-16 0,-16 C0.6779999732971191,-16 1.3450000286102295,-15.958000183105469 2,-15.87600040435791 C9.892999649047852,-14.892000198364258 16,-8.159000396728516 16,0 C16,8.159000396728516 9.892999649047852,14.892000198364258 2,15.87600040435791 C1.3450000286102295,15.958000183105469 0.6779999732971191,16 0,16 C-8.836000442504883,16 -16,8.836999893188477 -16,0z"></path></g></g><g mask="url(#__lottie_element_35)" transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,26,24)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(79,195,247)" stroke-opacity="1" stroke-width="2" d=" M-11,0 C-11,-6.074999809265137 -6.074999809265137,-11 0,-11 C0.6830000281333923,-11 1.3519999980926514,-10.937999725341797 2,-10.819000244140625 C7.119999885559082,-9.878000259399414 11,-5.392000198364258 11,0 C11,5.39300012588501 7.119999885559082,9.878000259399414 2,10.817999839782715 C1.3519999980926514,10.937999725341797 0.6830000281333923,11 0,11 C-6.074999809265137,11 -11,6.074999809265137 -11,0z"></path></g><g opacity="1" transform="matrix(1,0,0,1,26,24)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(3,169,244)" stroke-opacity="1" stroke-width="2" d=" M-6,0 C-6,-3.312999963760376 -3.312999963760376,-6 0,-6 C0.7009999752044678,-6 1.375,-5.880000114440918 2,-5.658999919891357 C4.329999923706055,-4.835000038146973 6,-2.611999988555908 6,0 C6,2.611999988555908 4.329999923706055,4.835000038146973 2,5.6579999923706055 C1.375,5.880000114440918 0.7009999752044678,6 0,6 C-3.312999963760376,6 -6,3.312999963760376 -6,0z"></path></g></g><g transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,9.5,24)"><path fill="rgb(83,109,121)" fill-opacity="1" d=" M4.5,8 C4.5,8 -2.5,8 -2.5,8 C-3.6050000190734863,8 -4.5,7.105000019073486 -4.5,6 C-4.5,6 -4.5,-6 -4.5,-6 C-4.5,-7.105000019073486 -3.6050000190734863,-8 -2.5,-8 C-2.5,-8 4.5,-8 4.5,-8 C4.5,-8 4.5,8 4.5,8z"></path></g><g opacity="1" transform="matrix(1,0,0,1,20,24)"><path fill="rgb(120,144,156)" fill-opacity="1" d=" M6,18 C6,18 -6,8 -6,8 C-6,8 -6,-8 -6,-8 C-6,-8 6,-18 6,-18 C6,-18 6,18 6,18z"></path></g></g></g></svg>`;
const markdown_icon = `<svg width="1.5em" height="1.5em" viewBox="0 0 1024 1024"><path d="M265.61429932 63.6656706h493.57455644c111.51629209 0 201.91670068 90.40220771 201.91670068 201.91580157v493.57545556c0 111.51449297-90.40040859 201.91670068-201.91670068 201.91670069H265.61429932c-111.51539297 0-201.91580068-90.40220771-201.91580069-201.91670069V265.58147217c0-111.51359385 90.40040859-201.91580068 201.91580069-201.91580157z" fill="#707070"></path><path d="M763.60576133 722.16141084L670.49099316 599.42972305h48.19382491V302.57788818h89.84188652v296.85183487h48.19382491L763.60576133 722.16141084zM519.02738545 472.82885791c0-13.71570117 0.30399346-28.21926709 0.91827773-43.48821445l-13.67612753 19.09855107c-0.1726831 0.54323174-0.34626533 1.10265205-0.52074757 1.62609698l-7.15195107 10.50577734-109.52234384 166.63092451-40.52562364-62.91054668h-0.25092949l-28.34248359-44.38850449-41.19926749-63.95563828h0.36425304l-8.60086846-13.47016729-0.46318536-1.8752291-14.42082305-21.30475518c1.05318633 33.22347451 1.60451191 57.42426622 1.60451192 72.50254365v229.53787296h-89.15835059V303.99532753h140.37862325l77.89348828 115.26944679h1.3346956l80.12037832-115.26944678H610.08255019v417.34224141H519.02828457V472.82885791z" fill="#ffffff"></path></svg>`;
const pdf_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_44)"><g transform="matrix(1,0,0,1,0,0)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,24,24)"><path fill="rgb(255,87,34)" fill-opacity="1" d=" M16,21 C16,21 -16,21 -16,21 C-16,21 -16,-21 -16,-21 C-16,-21 6,-21 6,-21 C6,-21 16,-11 16,-11 C16,-11 16,21 16,21z"></path></g><g opacity="1" transform="matrix(1,0,0,1,33.75,9.25)"><path fill="rgb(251,233,231)" fill-opacity="1" d=" M4.75,4.75 C4.75,4.75 -4.75,4.75 -4.75,4.75 C-4.75,4.75 -4.75,-4.75 -4.75,-4.75 C-4.75,-4.75 4.75,4.75 4.75,4.75z"></path></g></g><g transform="matrix(1,0,0,1,24,24)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path fill="rgb(255,255,255)" fill-opacity="1" d=" M-8,15 C-8.399999618530273,15 -8.699999809265137,14.899999618530273 -9,14.800000190734863 C-10.100000381469727,14.199999809265137 -10.199999809265137,13.300000190734863 -10,12.600000381469727 C-9.600000381469727,11.399999618530273 -7.400000095367432,9.899999618530273 -4.5,8.600000381469727 C-4.5,8.600000381469727 -4.5,8.600000381469727 -4.5,8.600000381469727 C-3.200000047683716,6.199999809265137 -2.200000047683716,3.700000047683716 -1.600000023841858,1.600000023841858 C-2.5999999046325684,-0.30000001192092896 -3.0999999046325684,-2.0999999046325684 -3.0999999046325684,-3.4000000953674316 C-3.0999999046325684,-4.099999904632568 -2.9000000953674316,-4.699999809265137 -2.5999999046325684,-5.199999809265137 C-2.200000047683716,-5.699999809265137 -1.600000023841858,-6 -0.800000011920929,-6 C0.10000000149011612,-6 0.800000011920929,-5.5 1.100000023841858,-4.599999904632568 C1.600000023841858,-3.4000000953674316 1.2999999523162842,-1.2000000476837158 0.6000000238418579,1.2999999523162842 C1.600000023841858,3 2.799999952316284,4.599999904632568 4.099999904632568,5.800000190734863 C6,5.400000095367432 7.699999809265137,5.199999809265137 8.800000190734863,5.400000095367432 C10.699999809265137,5.699999809265137 11,7 11,7.5 C11,9.600000381469727 8.800000190734863,9.600000381469727 8,9.600000381469727 C6.5,9.600000381469727 5,9 3.700000047683716,7.900000095367432 C3.700000047683716,7.900000095367432 3.700000047683716,7.900000095367432 3.700000047683716,7.900000095367432 C1.2999999523162842,8.5 -1.100000023841858,9.300000190734863 -3,10.199999809265137 C-4,11.899999618530273 -5,13.300000190734863 -5.900000095367432,14.100000381469727 C-6.800000190734863,14.800000190734863 -7.5,15 -8,15z M-6.800000190734863,12.100000381469727 C-7.300000190734863,12.399999618530273 -7.699999809265137,12.699999809265137 -7.900000095367432,13 C-7.699999809265137,12.899999618530273 -7.300000190734863,12.699999809265137 -6.800000190734863,12.100000381469727z M6.800000190734863,7.400000095367432 C7.199999809265137,7.5 7.599999904632568,7.599999904632568 8,7.599999904632568 C8.600000381469727,7.599999904632568 8.899999618530273,7.5 9,7.5 C9,7.5 9,7.5 9,7.5 C8.899999618530273,7.400000095367432 8.199999809265137,7.199999809265137 6.800000190734863,7.400000095367432z M-0.20000000298023224,3.799999952316284 C-0.6000000238418579,5 -1.2000000476837158,6.300000190734863 -1.7000000476837158,7.5 C-0.5,7.099999904632568 0.699999988079071,6.699999809265137 1.899999976158142,6.400000095367432 C1.100000023841858,5.599999904632568 0.4000000059604645,4.699999809265137 -0.20000000298023224,3.799999952316284z M-0.800000011920929,-4 C-0.8999999761581421,-4 -0.8999999761581421,-4 -0.8999999761581421,-4 C-1,-3.9000000953674316 -1.100000023841858,-3.200000047683716 -0.699999988079071,-1.7000000476837158 C-0.6000000238418579,-2.9000000953674316 -0.6000000238418579,-3.799999952316284 -0.800000011920929,-4z"></path></g></g></g></svg>`;
const file_icon = `<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" viewBox="0 0 48 48" preserveAspectRatio="xMidYMid meet"><g clip-path="url(#__lottie_element_63)"><g transform="matrix(1,0,0,1,7.75,2.75)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,16.25,21.25)"><path fill="rgb(144,201,248)" fill-opacity="1" d=" M16,21 C16,21 -16,21 -16,21 C-16,21 -16,-21 -16,-21 C-16,-21 6,-21 6,-21 C6,-21 16,-11 16,-11 C16,-11 16,21 16,21z"></path></g></g><g transform="matrix(1,0,0,1,15,21)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(24,118,210)" stroke-opacity="1" stroke-width="2" d=" M1,1 C1,1 18,1 18,1"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(24,118,210)" stroke-opacity="1" stroke-width="2" d=" M1,5 C1,5 14,5 14,5"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(24,118,210)" stroke-opacity="1" stroke-width="2" d=" M1,9 C1,9 18,9 18,9"></path></g><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="butt" stroke-linejoin="miter" fill-opacity="0" stroke-miterlimit="10" stroke="rgb(24,118,210)" stroke-opacity="1" stroke-width="2" d=" M1,13 C1,13 14,13 14,13"></path></g></g><g transform="matrix(1,0,0,1,28.75,4.25)" opacity="1" style="display: block;"><g opacity="1" transform="matrix(1,0,0,1,5,5)"><path fill="rgb(224,245,253)" fill-opacity="1" d=" M4.75,4.75 C4.75,4.75 -4.75,4.75 -4.75,4.75 C-4.75,4.75 -4.75,-4.75 -4.75,-4.75 C-4.75,-4.75 0,0 0,0 C0,0 4.75,4.75 4.75,4.75z"></path></g></g></g></svg>`;
const dwg_icon = `<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em"><path d="M0 0 C1.75489494 -0.00503792 1.75489494 -0.00503792 3.54524231 -0.01017761 C7.41095036 -0.01967147 11.276615 -0.02163021 15.14233398 -0.02270508 C16.47995459 -0.0241295 17.81757503 -0.02572561 19.15519524 -0.02749062 C26.16629337 -0.03673547 33.17737254 -0.04082697 40.18847656 -0.04003906 C46.69354028 -0.03943993 53.19852062 -0.0499616 59.70356327 -0.06578273 C65.31063902 -0.07892711 70.91768778 -0.08422002 76.52477878 -0.08358365 C79.86354041 -0.08333049 83.20216951 -0.08702076 86.54092598 -0.0967617 C90.27605069 -0.10663547 94.01096515 -0.10365404 97.74609375 -0.09765625 C98.83071899 -0.10327576 99.91534424 -0.10889526 101.03283691 -0.11468506 C115.32579435 -0.05680139 125.46046098 1.2527913 135.76123047 11.44262695 C137.25732065 12.95108924 138.72935027 14.48013082 140.20092773 16.01245117 C142.37798156 18.24997872 144.64073628 20.31219076 147.01342773 22.34057617 C152.91140396 27.43262647 158.2958956 33.05769879 163.76245117 38.60229492 C168.84791018 43.75370869 173.95463295 48.81319046 179.45385742 53.52661133 C190.63462849 63.19386644 201.2449815 72.82256137 203.32592773 88.14526367 C203.42237021 90.87837898 203.47377382 93.58604023 203.47309875 96.3187561 C203.47677544 97.1255202 203.48045213 97.93228431 203.48424023 98.7634958 C203.49522484 101.45797836 203.49911188 104.15242229 203.50292969 106.84692383 C203.50919789 108.78218202 203.515845 110.71743901 203.52284241 112.6526947 C203.54382872 118.99656341 203.55423421 125.34043224 203.56420898 131.68432617 C203.56825745 133.8690937 203.5723744 136.05386111 203.57655907 138.23862839 C203.59559245 148.49552383 203.60983189 158.75241212 203.61817104 169.00932181 C203.62796113 180.8548319 203.65433454 192.70015602 203.69467193 204.54560053 C203.72478378 213.70154851 203.7396349 222.85744298 203.74295205 232.01343954 C203.74530658 237.48308982 203.75432065 242.95254097 203.77941322 248.42213821 C203.80261511 253.56202601 203.80695908 258.70158237 203.79665184 263.84150887 C203.79615458 265.72976214 203.80253081 267.61803132 203.81620789 269.50623512 C203.83381019 272.07980482 203.82687916 274.65216961 203.81367493 277.22573853 C203.82464417 277.97651126 203.83561342 278.72728399 203.84691507 279.5008074 C203.80584358 282.80577514 203.54837928 284.81840656 201.67044353 287.57773399 C196.67137053 290.92008524 190.7221346 290.29064916 184.90687561 290.27897644 C183.65702721 290.28237478 183.65702721 290.28237478 182.38192934 290.28584176 C179.59770431 290.29215778 176.81352826 290.29135395 174.02929688 290.29052734 C172.02994219 290.29352029 170.03058809 290.29692313 168.03123474 290.30070496 C162.60567014 290.30953433 157.18012131 290.3118826 151.75455022 290.31252074 C148.36439999 290.31323173 144.97425377 290.31536694 141.58410454 290.31801796 C129.75593689 290.3272671 117.92778052 290.33135329 106.09960938 290.33056641 C95.07513644 290.32996538 84.05071241 290.34052324 73.02625185 290.35631007 C63.55858157 290.36938438 54.09092728 290.37475036 44.62324804 290.374111 C38.96968614 290.37385602 33.31616772 290.37670705 27.66261482 290.38728905 C22.34632109 290.39696842 17.03011242 290.39705028 11.71381569 290.38977242 C9.76394273 290.38872645 7.81406447 290.39109015 5.86420059 290.39713287 C3.20002156 290.40485392 0.53613624 290.40020724 -2.1280365 290.39250183 C-2.89730734 290.39764539 -3.66657819 290.40278896 -4.45916027 290.40808839 C-9.16039495 290.37809598 -13.22130265 289.83373758 -17.67407227 288.14526367 C-20.46372322 283.96078723 -20.79791933 280.28536307 -20.80550003 275.33847427 C-20.80934118 274.39355252 -20.81318232 273.44863076 -20.81713986 272.47507501 C-20.81627338 271.44522225 -20.8154069 270.4153695 -20.81451416 269.35430908 C-20.81748528 268.25382791 -20.8204564 267.15334674 -20.82351756 266.01951766 C-20.8322027 262.32477168 -20.83371266 258.63005812 -20.83520508 254.93530273 C-20.83983336 252.28910164 -20.8448375 249.64290348 -20.85025024 246.9967041 C-20.86381945 239.80241214 -20.86985602 232.60812576 -20.8742609 225.41382313 C-20.87702558 220.91994166 -20.88126334 216.42606233 -20.88576508 211.93218231 C-20.89795565 199.48479981 -20.90825554 187.03741902 -20.91164017 174.59003067 C-20.91185973 173.7937153 -20.9120793 172.99739992 -20.91230552 172.17695378 C-20.9125238 171.37875745 -20.91274207 170.58056113 -20.91296697 169.75817704 C-20.91341043 168.14078665 -20.91385699 166.52339625 -20.91430664 164.90600586 C-20.91452807 164.10372817 -20.9147495 163.30145049 -20.91497764 162.47486135 C-20.9189251 149.4770487 -20.93637849 136.47929213 -20.95966616 123.48150113 C-20.98339373 110.13020064 -20.99584265 96.77892826 -20.99700809 83.42760634 C-20.99792403 75.93400883 -21.00365604 68.4404844 -21.0218277 60.94690704 C-21.03724763 54.56569998 -21.042338 48.18458861 -21.0340896 41.80336645 C-21.03018981 38.54955591 -21.03272051 35.2959777 -21.04514694 32.04218292 C-21.05784698 28.50934085 -21.05199963 24.97699154 -21.04156494 21.44415283 C-21.04962135 20.42322296 -21.05767775 19.4022931 -21.06597829 18.35042596 C-21.0228058 12.09155992 -20.04823815 6.94486164 -17.67407227 1.14526367 C-11.79830971 -0.12524939 -5.97947267 -0.00246617 0 0 Z " fill="#000000" transform="translate(57.674072265625,6.854736328125)"/><path d="M0 0 C1.98 0 3.96 0 6 0 C6 21.45 6 42.9 6 65 C13.59 65 21.18 65 29 65 C29 72.92 29 80.84 29 89 C69.92 89 110.84 89 153 89 C153 90.65 153 92.3 153 94 C112.08 94 71.16 94 29 94 C29 101.92 29 109.84 29 118 C21.41 118 13.82 118 6 118 C6 128.23 6 138.46 6 149 C8.64 149.33 11.28 149.66 14 150 C16.35888672 150.63085938 16.35888672 150.63085938 18.3046875 151.34375 C21.66848948 152.53284173 25.03861472 153.657667 28.4453125 154.71875 C29.37730469 155.01136719 30.30929688 155.30398437 31.26953125 155.60546875 C33.1802927 156.20405202 35.09175878 156.80039045 37.00390625 157.39453125 C40.96985486 158.64317249 44.88141453 159.87985727 48.68359375 161.5703125 C52.37957993 163.16363516 56.07019215 164.28750276 59.9375 165.375 C61.46382085 165.8154399 62.98985718 166.25686685 64.515625 166.69921875 C65.27552734 166.91884277 66.03542969 167.1384668 66.81835938 167.36474609 C75.33822698 169.84557594 83.7702647 172.58059689 92.18359375 175.3984375 C92.83110092 175.61528702 93.47860809 175.83213654 94.14573669 176.05555725 C97.40381482 177.14748411 100.66040923 178.24355246 103.91479492 179.34643555 C111.15791782 181.78395639 118.42177309 184.04240034 125.78295898 186.09716797 C133.71546081 188.32334933 141.47454689 190.6375635 149 194 C150.32 194.33 151.64 194.66 153 195 C153 222.39 153 249.78 153 278 C83.04 278 13.08 278 -59 278 C-59 215.63 -59 153.26 -59 89 C-47.12 89 -35.24 89 -23 89 C-23 81.08 -23 73.16 -23 65 C-15.41 65 -7.82 65 0 65 C0 43.55 0 22.1 0 0 Z " fill="#F4DE67" transform="translate(103,11)"/><path d="M0 0 C40.92 0 81.84 0 124 0 C124 33.33 124 66.66 124 101 C116.17647059 99.88235294 116.17647059 99.88235294 113.0625 98.75 C108.73578216 97.23601983 104.37823659 95.85554124 100 94.5 C92.01634396 92.01477251 84.11347184 89.40544751 76.25 86.5625 C69.5557252 84.16455082 62.81342961 82.03092613 56 80 C45.94549465 77.00008023 35.89149406 74.00001786 25.875 70.875 C24.75810791 70.53106201 24.75810791 70.53106201 23.61865234 70.18017578 C19.70218908 68.94923741 15.90147927 67.5771031 12.10546875 66.01171875 C6.97806637 63.92394974 1.77397382 62.39218904 -3.5625 60.9375 C-5.33518875 60.44861656 -7.10733101 59.95774697 -8.87890625 59.46484375 C-10.03241577 59.14954712 -10.03241577 59.14954712 -11.20922852 58.82788086 C-15.1707834 57.65268773 -19.07986015 56.30671328 -23 55 C-23 44.77 -23 34.54 -23 24 C-15.41 24 -7.82 24 0 24 C0 16.08 0 8.16 0 0 Z " fill="#2F557A" transform="translate(132,105)"/><path d="M0 0 C10.56 -0.061875 21.12 -0.12375 32 -0.1875 C35.320625 -0.21481201 38.64125 -0.24212402 42.0625 -0.27026367 C44.70832964 -0.2790294 47.35416333 -0.28667314 50 -0.29296875 C51.01731201 -0.30472893 51.01731201 -0.30472893 52.05517578 -0.31672668 C69.8608626 -0.51207251 69.8608626 -0.51207251 76.8125 6 C77.46863281 6.6084375 78.12476563 7.216875 78.80078125 7.84375 C82.26957933 11.24477405 85.69990171 14.68062224 89.09375 18.15625 C91.17043425 20.23773654 93.33280954 22.16789137 95.56738281 24.07836914 C100.51286301 28.38997755 105.17017786 32.97168101 109.828125 37.58984375 C110.73955261 38.49319962 111.65098022 39.39655548 112.59002686 40.32728577 C114.50476855 42.22713348 116.4170068 44.12946693 118.328125 46.03295898 C120.76274999 48.45647209 123.20884875 50.86805953 125.65761185 53.27727413 C128.01481248 55.60191524 130.35790374 57.94061891 132.703125 60.27734375 C133.57608215 61.13279282 134.44903931 61.98824188 135.34844971 62.86961365 C143.41395379 70.96407906 147 77.25878353 147 89 C106.08 89 65.16 89 23 89 C23 81.08 23 73.16 23 65 C15.41 65 7.82 65 0 65 C0 43.55 0 22.1 0 0 Z " fill="#0F3B68" transform="translate(109,11)"/><path d="M0 0 C1.98 0 3.96 0 6 0 C6 21.45 6 42.9 6 65 C13.59 65 21.18 65 29 65 C29 72.92 29 80.84 29 89 C69.92 89 110.84 89 153 89 C153 90.65 153 92.3 153 94 C112.08 94 71.16 94 29 94 C29 101.92 29 109.84 29 118 C21.41 118 13.82 118 6 118 C6 128.23 6 138.46 6 149 C8.64 149.33 11.28 149.66 14 150 C16.22265625 150.578125 16.22265625 150.578125 18.0625 151.25 C18.7946875 151.50910156 19.526875 151.76820313 20.28125 152.03515625 C21.1784375 152.35355469 22.075625 152.67195312 23 153 C25.68434897 153.90533468 28.37355812 154.7959151 31.0625 155.6875 C32.38679717 156.12867091 33.71102207 156.57005887 35.03515625 157.01171875 C36.01355469 157.33785156 36.99195313 157.66398438 38 158 C38 158.33 38 158.66 38 159 C32.80680803 158.6537872 28.64505699 157.93582834 23.8125 156 C15.35832888 153.0091885 6.54765671 153.2900687 -2.3203125 153.07666016 C-6.13613399 152.96749762 -9.94105531 152.74853999 -13.75 152.5 C-15.64685547 152.37818359 -15.64685547 152.37818359 -17.58203125 152.25390625 C-20.54283362 152.03396093 -23.4863022 151.75838062 -26.4375 151.4375 C-30.97925097 150.94399905 -35.43341538 150.92634541 -40 151 C-40.226875 151.7425 -40.45375 152.485 -40.6875 153.25 C-42.24407532 156.51139591 -44.08518854 157.92894975 -47 160 C-46.125 154.25 -46.125 154.25 -45 152 C-46.9490625 152.2165625 -46.9490625 152.2165625 -48.9375 152.4375 C-49.66839844 152.51871094 -50.39929688 152.59992188 -51.15234375 152.68359375 C-53.01140229 152.81886614 -53.01140229 152.81886614 -54 154 C-54.19267287 155.68990977 -54.31980798 157.38733939 -54.4206543 159.08520508 C-54.48709641 160.17597855 -54.55353851 161.26675201 -54.62199402 162.39057922 C-54.68872818 163.58813339 -54.75546234 164.78568756 -54.82421875 166.01953125 C-54.89413528 167.26127609 -54.96405182 168.50302094 -55.03608704 169.78239441 C-55.18257753 172.43644346 -55.32642938 175.09051792 -55.46704102 177.74487305 C-55.67810854 181.70286239 -55.91946888 185.65881794 -56.15820312 189.61523438 C-57.07164738 205.96861999 -56.78401501 221.86772524 -55.25935364 238.17472839 C-54.16238446 250.12457381 -53.86644712 262.0099194 -54 274 C-53.19369141 273.99476318 -52.38738281 273.98952637 -51.55664062 273.98413086 C-47.87110181 273.96322638 -44.18557552 273.95029714 -40.5 273.9375 C-39.2315625 273.92912109 -37.963125 273.92074219 -36.65625 273.91210938 C-35.41875 273.90888672 -34.18125 273.90566406 -32.90625 273.90234375 C-31.20952148 273.89448853 -31.20952148 273.89448853 -29.47851562 273.88647461 C-26 274 -26 274 -22.28346252 274.49900818 C-18.18149728 275.0260992 -14.1183378 275.14141733 -9.98608398 275.12939453 C-9.22872452 275.13114685 -8.47136505 275.13289917 -7.6910553 275.13470459 C-5.20937749 275.1390728 -2.72777218 275.13620085 -0.24609375 275.1328125 C1.50015781 275.13348747 3.24640928 275.13445911 4.99266052 275.13571167 C8.64819231 275.13718227 12.30369959 275.13505645 15.95922852 275.13037109 C20.60297658 275.12470391 25.24666645 275.1279377 29.89041233 275.13394356 C33.49820884 275.1375919 37.10599203 275.13639066 40.71378899 275.13381577 C42.42349187 275.1331567 44.13319603 275.13393846 45.84289742 275.13629532 C63.16359637 275.7985183 63.16359637 275.7985183 80 273 C82.01779311 272.90525114 84.0385784 272.86927784 86.05859375 272.8671875 C87.24904297 272.86589844 88.43949219 272.86460937 89.66601562 272.86328125 C91.53290039 272.86908203 91.53290039 272.86908203 93.4375 272.875 C95.29858398 272.86919922 95.29858398 272.86919922 97.19726562 272.86328125 C98.38900391 272.86457031 99.58074219 272.86585938 100.80859375 272.8671875 C101.89970459 272.86831543 102.99081543 272.86944336 104.11499023 272.87060547 C106.5913723 272.98167279 108.64092233 273.28088657 111 274 C111.33 272.68 111.66 271.36 112 270 C112.33 270.66 112.66 271.32 113 272 C116.80592493 273.26864164 120.40870641 273.22320072 124.375 273.25 C125.13039062 273.270625 125.88578125 273.29125 126.6640625 273.3125 C131.36682087 273.34538642 134.05854586 272.8047801 138 270 C138.66 270 139.32 270 140 270 C140 271.32 140 272.64 140 274 C142.64 273.34 145.28 272.68 148 272 C149.86247699 246.35366477 151.28514609 220.72651416 151 195 C151.66 195 152.32 195 153 195 C153 222.39 153 249.78 153 278 C83.04 278 13.08 278 -59 278 C-59 215.63 -59 153.26 -59 89 C-47.12 89 -35.24 89 -23 89 C-23 81.08 -23 73.16 -23 65 C-15.41 65 -7.82 65 0 65 C0 43.55 0 22.1 0 0 Z " fill="#F8F9FA" transform="translate(103,11)"/><path d="M0 0 C19.47 0 38.94 0 59 0 C59 21.45 59 42.9 59 65 C51.41 65 43.82 65 36 65 C36 72.92 36 80.84 36 89 C24.12 89 12.24 89 0 89 C0 59.63 0 30.26 0 0 Z " fill="#164370" transform="translate(44,11)"/><path d="M0 0 C11.88 0 23.76 0 36 0 C36 7.92 36 15.84 36 24 C43.59 24 51.18 24 59 24 C59 33.9 59 43.8 59 54 C39.53 54 20.06 54 0 54 C0 36.18 0 18.36 0 0 Z " fill="#3F6081" transform="translate(44,105)"/><path d="M0 0 C0.33 0 0.66 0 1 0 C1 9.9 1 19.8 1 30 C2.32 30 3.64 30 5 30 C5 20.1 5 10.2 5 0 C5.33 0 5.66 0 6 0 C6 10.23 6 20.46 6 31 C8.64 31.33 11.28 31.66 14 32 C16.22265625 32.578125 16.22265625 32.578125 18.0625 33.25 C18.7946875 33.50910156 19.526875 33.76820313 20.28125 34.03515625 C21.62703125 34.51275391 21.62703125 34.51275391 23 35 C25.68434897 35.90533468 28.37355812 36.7959151 31.0625 37.6875 C32.38679717 38.12867091 33.71102207 38.57005887 35.03515625 39.01171875 C36.01355469 39.33785156 36.99195313 39.66398437 38 40 C38 40.33 38 40.66 38 41 C32.80680803 40.6537872 28.64505699 39.93582834 23.8125 38 C15.35832888 35.0091885 6.54765671 35.2900687 -2.3203125 35.07666016 C-6.13613399 34.96749762 -9.94105531 34.74853999 -13.75 34.5 C-15.01457031 34.41878906 -16.27914062 34.33757812 -17.58203125 34.25390625 C-20.54283362 34.03396093 -23.4863022 33.75838062 -26.4375 33.4375 C-30.97925097 32.94399905 -35.43341538 32.92634541 -40 33 C-40.226875 33.7425 -40.45375 34.485 -40.6875 35.25 C-42.24407532 38.51139591 -44.08518854 39.92894975 -47 42 C-46.125 36.25 -46.125 36.25 -45 34 C-46.299375 34.144375 -47.59875 34.28875 -48.9375 34.4375 C-49.66839844 34.51871094 -50.39929688 34.59992188 -51.15234375 34.68359375 C-53.01140229 34.81886614 -53.01140229 34.81886614 -54 36 C-54.19267287 37.68990977 -54.31980798 39.38733939 -54.4206543 41.08520508 C-54.48709641 42.17597855 -54.55353851 43.26675201 -54.62199402 44.39057922 C-54.68872818 45.58813339 -54.75546234 46.78568756 -54.82421875 48.01953125 C-54.89413528 49.26127609 -54.96405182 50.50302094 -55.03608704 51.78239441 C-55.18257753 54.43644346 -55.32642938 57.09051792 -55.46704102 59.74487305 C-55.67810854 63.70286239 -55.91946888 67.65881794 -56.15820312 71.61523438 C-57.07164738 87.96861999 -56.78401501 103.86772524 -55.25935364 120.17472839 C-54.16238446 132.12457381 -53.86644712 144.0099194 -54 156 C-52.79053711 155.99214478 -52.79053711 155.99214478 -51.55664062 155.98413086 C-47.87110181 155.96322638 -44.18557552 155.95029714 -40.5 155.9375 C-39.2315625 155.92912109 -37.963125 155.92074219 -36.65625 155.91210938 C-35.41875 155.90888672 -34.18125 155.90566406 -32.90625 155.90234375 C-31.77509766 155.89710693 -30.64394531 155.89187012 -29.47851562 155.88647461 C-26 156 -26 156 -22.28346252 156.49900818 C-18.18149728 157.0260992 -14.1183378 157.14141733 -9.98608398 157.12939453 C-9.22872452 157.13114685 -8.47136505 157.13289917 -7.6910553 157.13470459 C-5.20937749 157.1390728 -2.72777218 157.13620085 -0.24609375 157.1328125 C1.50015781 157.13348747 3.24640928 157.13445911 4.99266052 157.13571167 C8.64819231 157.13718227 12.30369959 157.13505645 15.95922852 157.13037109 C20.60297658 157.12470391 25.24666645 157.1279377 29.89041233 157.13394356 C33.49820884 157.1375919 37.10599203 157.13639066 40.71378899 157.13381577 C42.42349187 157.1331567 44.13319603 157.13393846 45.84289742 157.13629532 C63.16359637 157.7985183 63.16359637 157.7985183 80 155 C82.01779311 154.90525114 84.0385784 154.86927784 86.05859375 154.8671875 C87.24904297 154.86589844 88.43949219 154.86460937 89.66601562 154.86328125 C90.91060547 154.86714844 92.15519531 154.87101563 93.4375 154.875 C95.29858398 154.86919922 95.29858398 154.86919922 97.19726562 154.86328125 C98.38900391 154.86457031 99.58074219 154.86585938 100.80859375 154.8671875 C101.89970459 154.86831543 102.99081543 154.86944336 104.11499023 154.87060547 C106.5913723 154.98167279 108.64092233 155.28088657 111 156 C111.33 154.68 111.66 153.36 112 152 C112.33 152.66 112.66 153.32 113 154 C116.80592493 155.26864164 120.40870641 155.22320072 124.375 155.25 C125.13039062 155.270625 125.88578125 155.29125 126.6640625 155.3125 C131.36682087 155.34538642 134.05854586 154.8047801 138 152 C138.66 152 139.32 152 140 152 C140 153.32 140 154.64 140 156 C142.64 155.34 145.28 154.68 148 154 C149.86247699 128.35366477 151.28514609 102.72651416 151 77 C151.66 77 152.32 77 153 77 C153 104.39 153 131.78 153 160 C83.04 160 13.08 160 -59 160 C-59 117.1 -59 74.2 -59 30 C-39.53 30 -20.06 30 0 30 C0 20.1 0 10.2 0 0 Z " fill="#FAEA80" transform="translate(103,129)"/><path d="M0 0 C13.53 0 27.06 0 41 0 C41 13.53 41 27.06 41 41 C27.47 41 13.94 41 0 41 C0 27.47 0 13.94 0 0 Z " fill="#295179" transform="translate(86,82)"/><path d="M0 0 C0.99 0.66 1.98 1.32 3 2 C3.33 1.34 3.66 0.68 4 0 C7.3 0 10.6 0 14 0 C14.0996515 4.81968303 14.17183311 9.63875277 14.21972656 14.45922852 C14.23971332 16.09540264 14.26691243 17.73150651 14.30175781 19.36743164 C14.67649921 37.42666063 14.67649921 37.42666063 10 44 C4.9616464 48.798432 1.37641243 49.18189251 -5.375 49.1875 C-6.14328125 49.19974609 -6.9115625 49.21199219 -7.703125 49.22460938 C-14.68466361 49.24272755 -14.68466361 49.24272755 -18 47 C-17.34 44.36 -16.68 41.72 -16 39 C-14.68 39.33 -13.36 39.66 -12 40 C-5.34940564 40.68697705 -5.34940564 40.68697705 0.625 38.25 C2.34763334 35.87062509 2.34763334 35.87062509 2 32 C1.44054687 32.32097656 0.88109375 32.64195312 0.3046875 32.97265625 C-3.71052365 34.76248766 -7.69908638 34.65227126 -12 34 C-15.84270061 32.21046791 -17.77480459 29.3903387 -19.875 25.75 C-21.64154843 19.86150522 -21.6387333 15.21678029 -19.9375 9.3125 C-15.06274863 0.97824765 -9.67582618 -1.60236612 0 0 Z " fill="#090907" transform="translate(233,236)"/><path d="M0 0 C3.96 0 7.92 0 12 0 C12 16.83 12 33.66 12 51 C8.7 51 5.4 51 2 51 C2 49.68 2 48.36 2 47 C1.05125 47.66 0.1025 48.32 -0.875 49 C-5.47030831 51.6005903 -9.83694255 51.97978813 -15 51 C-18.50490507 49.27687722 -20.54903817 46.60128244 -22.875 43.5 C-24.96494678 36.99794335 -25.00911783 29.97424202 -22.8125 23.5 C-22.214375 22.675 -21.61625 21.85 -21 21 C-20.38125 20.05125 -19.7625 19.1025 -19.125 18.125 C-14.16646565 14.75319664 -8.82689371 15.44354357 -3 16 C-2.34 16.33 -1.68 16.66 -1 17 C-0.67 11.39 -0.34 5.78 0 0 Z " fill="#060502" transform="translate(142,220)"/><path d="M0 0 C4.15476425 0.51017896 6.04445495 1.56507784 8.92578125 4.5703125 C9.64056641 5.3025 10.35535156 6.0346875 11.09179688 6.7890625 C11.82462891 7.55992188 12.55746094 8.33078125 13.3125 9.125 C14.76437437 10.63007084 16.2187875 12.13269696 17.67578125 13.6328125 C18.31427002 14.30199707 18.95275879 14.97118164 19.6105957 15.66064453 C21.57502075 17.58392243 23.56916656 19.37229536 25.65161133 21.16259766 C30.62181697 25.47699953 35.25170666 30.10809668 39.8984375 34.765625 C40.81460846 35.68083923 41.73077942 36.59605347 42.67471313 37.53900146 C44.5974303 39.46025667 46.51835817 41.38327769 48.43798828 43.30761719 C50.89582921 45.77119499 53.35818799 48.23020086 55.82187462 50.68793106 C58.18315876 53.0447369 60.5406306 55.4053404 62.8984375 57.765625 C63.78171722 58.64688049 64.66499695 59.52813599 65.57504272 60.43609619 C66.38994171 61.25414734 67.2048407 62.07219849 68.04443359 62.91503906 C68.76198822 63.63338928 69.47954285 64.3517395 70.21884155 65.09185791 C72 67 72 67 74 70 C73.625 72.1875 73.625 72.1875 73 74 C72.38125 73.113125 71.7625 72.22625 71.125 71.3125 C62.62737275 61.16322126 46.29361708 59.30462875 34 58 C28.67256993 57.56278005 23.33848879 57.26345789 18 57 C17.98541748 56.44763672 17.97083496 55.89527344 17.95581055 55.32617188 C17.69616387 28.18801798 17.69616387 28.18801798 5.3125 4.9375 C4.549375 4.298125 3.78625 3.65875 3 3 C2 2 1 1 0 0 Z " fill="#48698B" transform="translate(179,14)"/><path d="M0 0 C3.96 0 7.92 0 12 0 C12.50423557 2.74928442 13.00353426 5.49931143 13.5 8.25 C13.64308594 9.02730469 13.78617188 9.80460938 13.93359375 10.60546875 C14.13662109 11.73662109 14.13662109 11.73662109 14.34375 12.890625 C14.46943359 13.58188477 14.59511719 14.27314453 14.72460938 14.98535156 C15 17 15 17 15 21 C15.66 21 16.32 21 17 21 C17.16435547 20.10861328 17.16435547 20.10861328 17.33203125 19.19921875 C18.57497728 12.70154153 20.18614884 6.3605714 22 0 C24.97 0 27.94 0 31 0 C33.475 9.9 33.475 9.9 36 20 C37.50926897 15.47219308 38.66114467 11.26903024 39.625 6.625 C39.88539063 5.37976563 40.14578125 4.13453125 40.4140625 2.8515625 C40.70410156 1.44003906 40.70410156 1.44003906 41 0 C44.63 0 48.26 0 52 0 C51.30484772 5.73262564 49.43944932 10.94675553 47.5625 16.375 C45.43795112 22.54276252 43.4811017 28.64391533 42 35 C38.37 35 34.74 35 31 35 C30.32438628 32.4604163 29.65934172 29.91881165 29 27.375 C28.80921875 26.66214844 28.6184375 25.94929688 28.421875 25.21484375 C27.34982713 21.04151456 26.78053186 17.34821249 27 13 C26.34 13 25.68 13 25 13 C24.95101562 13.73605469 24.90203125 14.47210938 24.8515625 15.23046875 C24.77679688 16.20628906 24.70203125 17.18210938 24.625 18.1875 C24.55539063 19.15042969 24.48578125 20.11335938 24.4140625 21.10546875 C23.99578755 24.02944738 23.15387146 26.29561377 22 29 C21.62406934 30.9924325 21.28020455 32.9918674 21 35 C17.37 35 13.74 35 10 35 C8.73561262 30.65864459 7.47221241 26.31700358 6.2097168 21.97509766 C5.78029915 20.49878216 5.35061424 19.02254437 4.9206543 17.54638672 C4.30186413 15.42175458 3.68404299 13.29684269 3.06640625 11.171875 C2.87470352 10.51443298 2.68300079 9.85699097 2.48548889 9.17962646 C1.59987132 6.12937227 0.77058744 3.08234977 0 0 Z " fill="#0C0B05" transform="translate(158,236)"/><path d="M0 0 C0.33 0 0.66 0 1 0 C1 9.9 1 19.8 1 30 C2.32 30 3.64 30 5 30 C5 20.1 5 10.2 5 0 C5.33 0 5.66 0 6 0 C6 10.23 6 20.46 6 31 C8.64 31.33 11.28 31.66 14 32 C16.22265625 32.578125 16.22265625 32.578125 18.0625 33.25 C18.7946875 33.50910156 19.526875 33.76820313 20.28125 34.03515625 C21.62703125 34.51275391 21.62703125 34.51275391 23 35 C25.68434897 35.90533468 28.37355812 36.7959151 31.0625 37.6875 C32.38679717 38.12867091 33.71102207 38.57005887 35.03515625 39.01171875 C36.01355469 39.33785156 36.99195313 39.66398437 38 40 C38 40.33 38 40.66 38 41 C32.80680803 40.6537872 28.64505699 39.93582834 23.8125 38 C15.35832888 35.0091885 6.54765671 35.2900687 -2.3203125 35.07666016 C-6.13613399 34.96749762 -9.94105531 34.74853999 -13.75 34.5 C-15.01457031 34.41878906 -16.27914062 34.33757812 -17.58203125 34.25390625 C-20.54283362 34.03396093 -23.4863022 33.75838062 -26.4375 33.4375 C-30.97925097 32.94399905 -35.43341538 32.92634541 -40 33 C-40.226875 33.7425 -40.45375 34.485 -40.6875 35.25 C-42.24407532 38.51139591 -44.08518854 39.92894975 -47 42 C-46.125 36.25 -46.125 36.25 -45 34 C-46.299375 34.144375 -47.59875 34.28875 -48.9375 34.4375 C-49.66839844 34.51871094 -50.39929688 34.59992188 -51.15234375 34.68359375 C-53.01140229 34.81886614 -53.01140229 34.81886614 -54 36 C-54.17657358 37.46339024 -54.28805647 38.93469781 -54.37304688 40.40625 C-54.42980591 41.35757813 -54.48656494 42.30890625 -54.54504395 43.2890625 C-54.60236694 44.34867188 -54.65968994 45.40828125 -54.71875 46.5 C-54.78155151 47.63179687 -54.84435303 48.76359375 -54.90905762 49.9296875 C-55.04275995 52.3813679 -55.17371609 54.83319925 -55.30224609 57.28515625 C-55.48742904 60.76385224 -55.69011527 64.24114209 -55.89453125 67.71875 C-57.51105255 98.15507024 -57.53027145 128.46764444 -58 159 C11.63 159 81.26 159 153 159 C153 159.33 153 159.66 153 160 C83.04 160 13.08 160 -59 160 C-59 117.1 -59 74.2 -59 30 C-39.53 30 -20.06 30 0 30 C0 20.1 0 10.2 0 0 Z " fill="#CCC8A6" transform="translate(103,129)"/><path d="M0 0 C0.66 0 1.32 0 2 0 C2 27.06 2 54.12 2 82 C-24.07 82 -50.14 82 -77 82 C-77 81.67 -77 81.34 -77 81 C-76.0867395 80.970271 -76.0867395 80.970271 -75.1550293 80.93994141 C-60.4769722 80.61310953 -60.4769722 80.61310953 -46.0234375 78.3046875 C-43.73581242 77.96021886 -42.18609103 78.29768116 -40 79 C-39.505 77.02 -39.505 77.02 -39 75 C-38.67 75.66 -38.34 76.32 -38 77 C-34.19407507 78.26864164 -30.59129359 78.22320072 -26.625 78.25 C-25.86960938 78.270625 -25.11421875 78.29125 -24.3359375 78.3125 C-19.63317913 78.34538642 -16.94145414 77.8047801 -13 75 C-12.34 75 -11.68 75 -11 75 C-11 76.32 -11 77.64 -11 79 C-7.04 78.01 -7.04 78.01 -3 77 C-1.13752301 51.35366477 0.28514609 25.72651416 0 0 Z " fill="#EEE9BF" transform="translate(254,206)"/><path d="M0 0 C1.69140625 1.12109375 1.69140625 1.12109375 3 3 C3.43359375 6.03125 3.43359375 6.03125 3.4375 9.5 C3.45683594 10.6446875 3.47617188 11.789375 3.49609375 12.96875 C3 16 3 16 1.1328125 17.8828125 C-1.50825989 19.26623137 -3.0576048 19.45267618 -6 19 C-8.5048111 17.12139167 -8.98700625 16.03898126 -10 13 C-10.38999509 8.92755129 -10.51753692 5.24817727 -8.9375 1.4375 C-5.93408933 -0.79083695 -3.62113687 -0.45264211 0 0 Z " fill="#EAC80F" transform="translate(139,244)"/><path d="M0 0 C3.28241783 0.55870942 4.02132251 0.86316101 5.9375 3.5 C6.3359375 6.3125 6.3359375 6.3125 6.3125 9.5 C6.32023438 10.551875 6.32796875 11.60375 6.3359375 12.6875 C5.9375 15.5 5.9375 15.5 4.59765625 17.34375 C1.93135217 19.20075237 0.08679843 19.01417117 -3.0625 18.5 C-5.55619699 16.40004464 -6.80595547 14.79842946 -7.4453125 11.5625 C-7.65599867 7.85442334 -7.23202866 5.81297599 -5.4375 2.5 C-3.0625 0.5 -3.0625 0.5 0 0 Z " fill="#F1E8B5" transform="translate(230.0625,243.5)"/><path d="M0 0 C0.33 0 0.66 0 1 0 C1.59167599 8.17150182 2.17548527 16.34352432 2.75195312 24.51611328 C2.95917308 27.42657469 3.17314247 30.33638793 3.390625 33.24609375 C3.48995363 34.64320289 3.58895124 36.04033563 3.6875 37.4375 C3.77386719 38.61183594 3.86023437 39.78617187 3.94921875 40.99609375 C3.99785393 43.87305199 3.60335343 46.20222781 3 49 C2.91092292 50.89419783 2.86982596 52.79121591 2.875 54.6875 C2.87242188 55.64011719 2.86984375 56.59273438 2.8671875 57.57421875 C2.83929591 60.00996498 2.83929591 60.00996498 4 62 C7.02934491 62.65772428 7.02934491 62.65772428 10 63 C10 63.33 10 63.66 10 64 C6.7 64 3.4 64 0 64 C0 42.88 0 21.76 0 0 Z " fill="#FDF7D1" transform="translate(45,224)"/><path d="M0 0 C2.46324069 3.69486103 2.38991688 5.63293092 2 10 C0.9375 11.9375 0.9375 11.9375 -1 13 C-4.5625 13.375 -4.5625 13.375 -8 13 C-10.46324069 9.30513897 -10.38991688 7.36706908 -10 3 C-7.780776 -1.04682024 -4.19656174 -0.45780674 0 0 Z " fill="#0F0E04" transform="translate(111,258)"/><path d="M0 0 C1.04976964 3.14930893 1.10131595 5.38814456 1.0625 8.6875 C1.05347656 9.68136719 1.04445312 10.67523438 1.03515625 11.69921875 C1.02355469 12.45847656 1.01195312 13.21773438 1 14 C2.06806885 13.98428955 2.06806885 13.98428955 3.15771484 13.96826172 C20.55061172 13.74852098 37.68251046 14.36315333 55 16 C55 16.33 55 16.66 55 17 C48.29226939 17.05085414 41.58458881 17.08579828 34.87670898 17.10986328 C32.59641665 17.11989935 30.31613711 17.13353115 28.03588867 17.15087891 C24.75175816 17.17523233 21.46779833 17.18650728 18.18359375 17.1953125 C17.16978134 17.20563507 16.15596893 17.21595764 15.11143494 17.22659302 C9.69659087 17.22744466 5.07509198 16.9722286 0 15 C-1.30459914 12.39080172 -1.1326594 10.41057385 -1.125 7.5 C-1.12757812 6.5203125 -1.13015625 5.540625 -1.1328125 4.53125 C-1 2 -1 2 0 0 Z " fill="#F8EDA2" transform="translate(48,271)"/><path d="M0 0 C3.96 0 7.92 0 12 0 C12 16.83 12 33.66 12 51 C11.67 51 11.34 51 11 51 C10.02941168 45.33431663 9.86876942 39.87005197 9.90234375 34.12890625 C9.9037587 33.206577 9.90517365 32.28424774 9.90663147 31.33396912 C9.91219494 28.41011202 9.92474058 25.48633365 9.9375 22.5625 C9.94251972 20.57096465 9.9470818 18.5794281 9.95117188 16.58789062 C9.96215238 11.72523044 9.97939161 6.86262853 10 2 C7.03 2 4.06 2 1 2 C1 7.61 1 13.22 1 19 C0.34 18.67 -0.32 18.34 -1 18 C-0.505 9.09 -0.505 9.09 0 0 Z " fill="#62540A" transform="translate(142,220)"/><path d="M0 0 C8.80171974 0.61358142 17.35954742 2.29549385 26 4 C26 4.66 26 5.32 26 6 C26.71285156 6.12632812 27.42570312 6.25265625 28.16015625 6.3828125 C35.08033392 7.88678509 41.77936585 10.63749506 48 14 C44.31394933 15.22868356 43.03103546 14.61753246 39.37109375 13.453125 C38.25283203 13.1025 37.13457031 12.751875 35.98242188 12.390625 C34.22768555 11.82601562 34.22768555 11.82601562 32.4375 11.25 C30.1446097 10.52579325 27.851642 9.80183148 25.55859375 9.078125 C23.89328613 8.54795776 23.89328613 8.54795776 22.19433594 8.00708008 C18.50007712 6.84238903 14.79192878 5.73001478 11.0793457 4.62548828 C8.66242227 3.89845319 6.26545842 3.1221714 3.875 2.3125 C3.12992188 2.06113281 2.38484375 1.80976563 1.6171875 1.55078125 C1.08351562 1.36902344 0.54984375 1.18726563 0 1 C0 0.67 0 0.34 0 0 Z " fill="#F6DA38" transform="translate(138,173)"/><path d="M0 0 C5.45761037 -0.21281843 9.76725429 1.1037919 14.80810547 2.94262695 C16.38585008 3.49449691 17.96397329 4.04528571 19.54248047 4.5949707 C20.29464844 4.86035645 21.04681641 5.12574219 21.82177734 5.39916992 C25.81636766 6.78212591 29.87021357 7.96638405 33.93310547 9.13012695 C33.93310547 9.46012695 33.93310547 9.79012695 33.93310547 10.13012695 C28.7399135 9.78391416 24.57816245 9.0659553 19.74560547 7.13012695 C12.09496875 4.40267989 4.33183241 4.49581652 -3.69970703 4.3059082 C-14.93905966 4.00452461 -14.93905966 4.00452461 -19.06689453 3.13012695 C-19.39689453 2.47012695 -19.72689453 1.81012695 -20.06689453 1.13012695 C-17.23370594 0.96061994 -14.40038465 0.79445162 -11.56689453 0.63012695 C-10.77541016 0.58243164 -9.98392578 0.53473633 -9.16845703 0.4855957 C-6.11278069 0.31027001 -3.05459685 0.19231043 0 0 Z " fill="#F7EA9E" transform="translate(107.06689453125,159.869873046875)"/><path d="M0 0 C4.26248908 0.38749901 8.08277828 0.92374113 12.12109375 2.35546875 C18.12718415 4.41606069 24.23771734 6.07091676 30.359375 7.75 C35.44100599 9.17226407 40.20482769 10.79290699 45 13 C41.06745724 14.47470354 37.48619461 13.6069135 33.5 12.8125 C32.79673584 12.67593994 32.09347168 12.53937988 31.36889648 12.39868164 C25.1163007 11.12803625 18.841865 9.60929594 13 7 C12.67 6.34 12.34 5.68 12 5 C10.00708223 4.21655744 7.97948177 3.51983635 5.9375 2.875 C4.83277344 2.52179688 3.72804687 2.16859375 2.58984375 1.8046875 C1.73519531 1.53914062 0.88054687 1.27359375 0 1 C0 0.67 0 0.34 0 0 Z " fill="#EDE6AF" transform="translate(207,192)"/><path d="M0 0 C0.78503906 0.01417969 1.57007813 0.02835938 2.37890625 0.04296875 C3.55259766 0.05263672 3.55259766 0.05263672 4.75 0.0625 C6.94140625 0.23046875 6.94140625 0.23046875 9.94140625 1.23046875 C9.62890625 4.60546875 9.62890625 4.60546875 8.94140625 8.23046875 C7.95140625 8.89046875 6.96140625 9.55046875 5.94140625 10.23046875 C6.81640625 4.48046875 6.81640625 4.48046875 7.94140625 2.23046875 C6.64203125 2.37484375 5.34265625 2.51921875 4.00390625 2.66796875 C2.90755859 2.78978516 2.90755859 2.78978516 1.7890625 2.9140625 C-0.06999604 3.04933489 -0.06999604 3.04933489 -1.05859375 4.23046875 C-1.20431031 5.93907056 -1.28587449 7.65323278 -1.33984375 9.3671875 C-1.37722656 10.41970703 -1.41460937 11.47222656 -1.453125 12.55664062 C-1.48792969 13.66587891 -1.52273437 14.77511719 -1.55859375 15.91796875 C-1.62791208 18.08865956 -1.70072425 20.25924214 -1.77734375 22.4296875 C-1.80763672 23.39737061 -1.83792969 24.36505371 -1.86914062 25.36206055 C-2.06779453 28.36977276 -2.51654022 31.26700505 -3.05859375 34.23046875 C-3.38859375 34.23046875 -3.71859375 34.23046875 -4.05859375 34.23046875 C-4.10797075 29.70981447 -4.14430198 25.18931658 -4.16845703 20.66845703 C-4.17852493 19.13001777 -4.19218021 17.59159768 -4.20947266 16.05322266 C-4.23368692 13.84402742 -4.24506866 11.6350848 -4.25390625 9.42578125 C-4.26422882 8.73614288 -4.27455139 8.04650452 -4.28518677 7.33596802 C-4.28558853 5.63245969 -4.18050401 3.92960932 -4.05859375 2.23046875 C-2.05859375 0.23046875 -2.05859375 0.23046875 0 0 Z " fill="#F7EA9D" transform="translate(50.05859375,160.76953125)"/><path d="M0 0 C0.33 0 0.66 0 1 0 C1.02465288 4.68139254 1.04283739 9.36274759 1.05493164 14.04418945 C1.05997157 15.63794614 1.0668035 17.23169819 1.07543945 18.82543945 C1.08751999 21.11150253 1.09323155 23.39750467 1.09765625 25.68359375 C1.10281754 26.40026718 1.10797882 27.11694061 1.11329651 27.85533142 C1.11349263 29.57063672 1.06192007 31.28581266 1 33 C-0.56095477 34.56095477 -2.09000895 34.16961928 -4.25 34.1875 C-7.91389379 34.14666042 -10.74437955 33.83128651 -14 32 C-14.33 31.34 -14.66 30.68 -15 30 C-13.35 29.34 -11.7 28.68 -10 28 C-10 29.32 -10 30.64 -10 32 C-7.36 31.34 -4.72 30.68 -2 30 C-1.34 20.1 -0.68 10.2 0 0 Z " fill="#F7EA9E" transform="translate(253,253)"/><path d="M0 0 C5.13849062 1.45658002 10.26473666 2.94715755 15.375 4.5 C16.45974609 4.81904297 16.45974609 4.81904297 17.56640625 5.14453125 C19.39662271 5.70424097 21.20134065 6.34594205 23 7 C23.33 7.66 23.66 8.32 24 9 C26.34038186 10.13102526 26.34038186 10.13102526 29.0625 11.125 C30.44115234 11.65480469 30.44115234 11.65480469 31.84765625 12.1953125 C32.55792969 12.46085938 33.26820313 12.72640625 34 13 C30.86332092 14.02826931 29.16815258 13.99386675 26.109375 12.78515625 C25.40039062 12.51123047 24.69140625 12.23730469 23.9609375 11.95507812 C23.23132813 11.66052734 22.50171875 11.36597656 21.75 11.0625 C20.63238281 10.62647461 20.63238281 10.62647461 19.4921875 10.18164062 C17.65758186 9.46426278 15.82824935 8.73342561 14 8 C14 7.34 14 6.68 14 6 C12.43840941 5.51787786 10.87568072 5.03944127 9.3125 4.5625 C8.44238281 4.29566406 7.57226562 4.02882812 6.67578125 3.75390625 C4.12974079 3.03655471 1.5996577 2.482459 -1 2 C-0.67 1.34 -0.34 0.68 0 0 Z " fill="#E9DD86" transform="translate(186,184)"/><path d="M0 0 C0 0.66 0 1.32 0 2 C-4.24945853 3.03987597 -8.35927856 3.12989631 -12.70703125 3.09765625 C-13.79512337 3.09553383 -13.79512337 3.09553383 -14.90519714 3.09336853 C-17.2076745 3.08779931 -19.51005235 3.07525261 -21.8125 3.0625 C-23.37955588 3.05748102 -24.9466133 3.05291881 -26.51367188 3.04882812 C-30.34248589 3.03783998 -34.17122611 3.02059673 -38 3 C-38 2.67 -38 2.34 -38 2 C-37.38068604 1.98018066 -36.76137207 1.96036133 -36.12329102 1.93994141 C-33.26932611 1.84364769 -30.41599143 1.73439903 -27.5625 1.625 C-26.58861328 1.5940625 -25.61472656 1.563125 -24.61132812 1.53125 C-19.20031975 1.31408578 -14.19497773 0.79030502 -8.95898438 -0.62109375 C-5.79011033 -1.23401655 -3.13340939 -0.66668285 0 0 Z " fill="#F9F0B4" transform="translate(215,285)"/><path d="M0 0 C7.25637869 0.18018096 13.16441079 1.98597064 19.859375 4.72265625 C23.8525182 6.34673315 27.89815164 7.67906578 32 9 C25.74850396 11.41993395 17.68991788 7.43712591 11.7734375 5.1328125 C10.17999369 4.42704058 8.58985763 3.71381363 7 3 C4.68046559 2.25903762 2.35473033 1.62472437 0 1 C0 0.67 0 0.34 0 0 Z " fill="#F5D526" transform="translate(138,173)"/><path d="M0 0 C0.93199219 0.268125 1.86398438 0.53625 2.82421875 0.8125 C5.94689913 1.70581778 9.07584243 2.57450689 12.20703125 3.4375 C14.07555401 3.9582143 15.94404296 4.47904993 17.8125 5 C19.24239258 5.39058594 19.24239258 5.39058594 20.70117188 5.7890625 C21.61060547 6.04429687 22.52003906 6.29953125 23.45703125 6.5625 C24.28178955 6.79066406 25.10654785 7.01882812 25.95629883 7.25390625 C28 8 28 8 30 10 C23.48435282 9.47381114 17.84243521 8.22476452 11.6875 6.0625 C10.90310547 5.79759766 10.11871094 5.53269531 9.31054688 5.25976562 C5.73484573 4.03546014 2.35983008 2.74392297 -1 1 C-0.67 0.67 -0.34 0.34 0 0 Z " fill="#D8D38F" transform="translate(111,160)"/><path d="M0 0 C2.52284073 0.25743273 5.04238144 0.53051317 7.5625 0.8125 C8.26697266 0.88275391 8.97144531 0.95300781 9.69726562 1.02539062 C14.65701097 1.59678986 18.47692728 2.89216029 23 5 C24.30191187 5.42937834 25.61245011 5.83595615 26.9375 6.1875 C27.948125 6.455625 28.95875 6.72375 30 7 C26.59598052 8.13732426 24.22543336 7.83989957 20.75 7.0625 C19.85796875 6.86785156 18.9659375 6.67320312 18.046875 6.47265625 C17.03367188 6.23869141 17.03367188 6.23869141 16 6 C16 5.34 16 4.68 16 4 C14.64455078 3.81824219 14.64455078 3.81824219 13.26171875 3.6328125 C11.49248047 3.38144531 11.49248047 3.38144531 9.6875 3.125 C8.51574219 2.96257812 7.34398437 2.80015625 6.13671875 2.6328125 C3 2 3 2 0 0 Z " fill="#ECDD70" transform="translate(132,169)"/><path d="M0 0 C0.67417969 0.48082031 1.34835938 0.96164062 2.04296875 1.45703125 C5.60982735 3.31820582 8.30964992 3.50045093 12.3125 3.6875 C14.19388672 3.78611328 14.19388672 3.78611328 16.11328125 3.88671875 C17.54220703 3.94279297 17.54220703 3.94279297 19 4 C19 4.33 19 4.66 19 5 C18.21753906 5.06058594 17.43507812 5.12117188 16.62890625 5.18359375 C15.11103516 5.30927734 15.11103516 5.30927734 13.5625 5.4375 C12.55316406 5.51871094 11.54382813 5.59992188 10.50390625 5.68359375 C8.06359221 5.73211468 8.06359221 5.73211468 7 7 C5.14712498 7.07226502 3.29166122 7.0838122 1.4375 7.0625 C0.42558594 7.05347656 -0.58632812 7.04445313 -1.62890625 7.03515625 C-2.41136719 7.02355469 -3.19382813 7.01195312 -4 7 C-4 6.67 -4 6.34 -4 6 C-2.35 6 -0.7 6 1 6 C0.67 4.02 0.34 2.04 0 0 Z " fill="#E7E2C1" transform="translate(214,281)"/><path d="M0 0 C0 0.66 0 1.32 0 2 C-6.96779403 3.32719886 -13.92988911 3.08825381 -21 3 C-20.67 2.34 -20.34 1.68 -20 1 C-13.43983174 -0.49094733 -6.69023716 -0.09054456 0 0 Z " fill="#F6E896" transform="translate(206,284)"/><path d="M0 0 C0 0.66 0 1.32 0 2 C0.99 2.33 1.98 2.66 3 3 C-2.94 3 -8.88 3 -15 3 C-14.67 2.34 -14.34 1.68 -14 1 C-11.6015625 0.5859375 -11.6015625 0.5859375 -8.625 0.375 C-7.15933594 0.26285156 -7.15933594 0.26285156 -5.6640625 0.1484375 C-3.77831835 0.04336671 -1.88866907 0 0 0 Z " fill="#FDF9DC" transform="translate(236,285)"/><path d="M0 0 C1.21236328 0.01353516 1.21236328 0.01353516 2.44921875 0.02734375 C3.37154297 0.04474609 3.37154297 0.04474609 4.3125 0.0625 C4.3125 0.3925 4.3125 0.7225 4.3125 1.0625 C-1.60531337 3.12439931 -6.89168214 3.30417838 -13.125 3.1875 C-14.04732422 3.17847656 -14.96964844 3.16945313 -15.91992188 3.16015625 C-18.17605809 3.1367766 -20.43163684 3.10400916 -22.6875 3.0625 C-22.6875 2.7325 -22.6875 2.4025 -22.6875 2.0625 C-21.63949219 2.00191406 -20.59148437 1.94132812 -19.51171875 1.87890625 C-18.13279952 1.79448262 -16.75389395 1.70983553 -15.375 1.625 C-14.68470703 1.58568359 -13.99441406 1.54636719 -13.28320312 1.50585938 C-8.69894895 1.21795935 -4.58138498 -0.06639688 0 0 Z " fill="#F6E581" transform="translate(187.6875,283.9375)"/><path d="M0 0 C7.26 0 14.52 0 22 0 C17.5 3.375 17.5 3.375 13.671875 2.85546875 C12.87265625 2.75556641 12.0734375 2.65566406 11.25 2.55273438 C10.425 2.43220703 9.6 2.31167969 8.75 2.1875 C7.90953125 2.07857422 7.0690625 1.96964844 6.203125 1.85742188 C4.13335605 1.58694071 2.06634597 1.29549598 0 1 C0 0.67 0 0.34 0 0 Z " fill="#FEF8D6" transform="translate(64,160)"/><path d="M0 0 C7.15595346 0.70156407 14.01855181 2.30785021 21 4 C17.32002577 5.26273626 14.3081243 4.82645918 10.5 4.25 C9.3759375 4.09015625 8.251875 3.9303125 7.09375 3.765625 C3.99236199 2.99810979 2.35816251 2.10385087 0 0 Z " fill="#F5DD51" transform="translate(127,169)"/><path d="M0 0 C1.98 0 3.96 0 6 0 C6 1.65 6 3.3 6 5 C4.02 5 2.04 5 0 5 C0 3.35 0 1.7 0 0 Z " fill="#F3F5F7" transform="translate(103,100)"/><path d="M0 0 C2.912575 0.08566397 4.56798024 0.57910955 6.66796875 2.625 C8.16091772 4.38391375 9.60436262 6.16313019 11 8 C8 8 8 8 5.5 5.6875 C4.675 4.800625 3.85 3.91375 3 3 C2.401875 2.401875 1.80375 1.80375 1.1875 1.1875 C0.795625 0.795625 0.40375 0.40375 0 0 Z " fill="#436282" transform="translate(179,14)"/><path d="M0 0 C4.37702633 1.22556737 8.69677317 2.53060547 13 4 C9.45332822 5.25127906 7.27746562 4.72285053 3.75 3.5625 C2.85796875 3.27503906 1.9659375 2.98757812 1.046875 2.69140625 C0.37140625 2.46324219 -0.3040625 2.23507813 -1 2 C-0.67 1.34 -0.34 0.68 0 0 Z " fill="#E0DBA1" transform="translate(111,160)"/><path d="M0 0 C0 1.65 0 3.3 0 5 C-1.9375 4.625 -1.9375 4.625 -4 4 C-4.33 3.34 -4.66 2.68 -5 2 C-2 0 -2 0 0 0 Z " fill="#ECE1A4" transform="translate(243,281)"/><path d="M0 0 C0.66 0.66 1.32 1.32 2 2 C0.25 5.875 0.25 5.875 -2 7 C-2.125 4.625 -2.125 4.625 -2 2 C-1.34 1.34 -0.68 0.68 0 0 Z " fill="#F7E99A" transform="translate(55,171)"/></svg>`;

// Don't know new OS thing, so I just copied it from the original source code and edited something.
const Os = {
    isWindows: navigator.userAgent.toUpperCase().indexOf('WIN') > -1, // .includes
    isMac: navigator.userAgent.toUpperCase().indexOf('MAC') > -1,
    isMacLike: /(Mac|iPhone|iPod|iPad)/i.test(navigator.userAgent),
    isIos: /(iPhone|iPod|iPad)/i.test(navigator.userAgent),
    isMobile: /Android|webOS|iPhone|iPad|iPod|iOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
};

function getDocumentHeight() {
    const D = document;
    return Math.max(
        D.body.scrollHeight, D.documentElement.scrollHeight,
        D.body.offsetHeight, D.documentElement.offsetHeight,
        D.body.clientHeight, D.documentElement.clientHeight
    );
}

// get search params
function getQueryVariable(variable) {
    const query = window.location.search.substring(1);
    const vars = query.split('&');
    let pair;
    for (let i = 0; i < vars.length; i++) {
        pair = vars[i].split('=');
        if (pair[0] == variable) {
            return pair[1];
        }
    }
    return (false);
}

function render(path) {
    if (path.indexOf("?") > 0) {
        path = path.substr(0, path.indexOf("?"));
    }
    title(path);
    nav(path);
    // .../0: This
    const reg = /\/\d+:$/g;
    if (path.includes("/fallback")) {
        // Used to store the state of some scroll events
        window.scroll_status = {
            // Whether the scroll event is bound
            event_bound: false,
            // "Scroll to the bottom, loading more data" event lock
            loading_lock: false
        };
        const can_preview = getQueryVariable('a');
        const id = getQueryVariable('id');
        if (can_preview) {
            return fallback(id, true);
        } else {
            return list(null, id, true);
        }
    } else if (window.MODEL.is_search_page) {
        // Used to store the state of some scroll events
        window.scroll_status = {
            // Whether the scroll event is bound
            event_bound: false,
            // "Scroll to the bottom, loading more data" event lock
            loading_lock: false
        };
        render_search_result_list();
    } else if (path.match(reg) || path.slice(-1) == '/') {
        // Used to store the state of some scroll events
        window.scroll_status = {
            // Whether the scroll event is bound
            event_bound: false,
            // "Scroll to the bottom, loading more data" event lock
            loading_lock: false
        };
        list(path);
    } else {
        file(path);
    }
}


// Render title
function title(path) {
    path = decodeURI(path);
    const cur = window.current_drive_order || 0;
    const drive_name = window.drive_names[cur];
    path = path.replace(`/${cur}:`, '');
    // $('title').html(document.siteName + ' - ' + path);
    const model = window.MODEL;
    if (model.is_search_page)
        $('title').html(`${drive_name} - Search results for ${model.q} `);
    else
        $('title').html(`${drive_name} - ${path}`);
}

// Render the navigation bar
function nav(path) {
    const model = window.MODEL;
    let html = "";
    const cur = window.current_drive_order || 0;
    html += `<nav class="navbar navbar-expand-lg${UI.fixed_header ?' fixed-top': ''} ${UI.header_style_class}">
    <div class="container-fluid">
  <a class="navbar-brand" href="/">${UI.logo_image ? '<img border="0" alt="'+UI.company_name+'" src="'+UI.logo_link_name+'" height="'+UI.logo_height+'" width="'+UI.logo_width+'">' : UI.logo_link_name}</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
      <li class="nav-item">
        <a class="nav-link" href="/${cur}:/">${UI.nav_link_1}</a>
      </li>`;
    const names = window.drive_names;
    const drive_name = window.drive_names[cur];

    // Dropdown to select different drive roots.
    html += `<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">${drive_name}</a><div class="dropdown-menu" aria-labelledby="navbarDropdown">`;
    names.forEach((name, idx) => {
        html += `<a class="dropdown-item"  href="/${idx}:/">${name}</a>`;
    });
    html += `</div></li>`;


    html += `<li class="nav-item">
    <a class="nav-link" href="${UI.contact_link}" target="_blank">${UI.nav_link_4}</a>
  </li>${UI.show_logout_button ?'<li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>': ''}`;

    const search_text = model.is_search_page ? (model.q || '') : '';
    const search_bar = `
</ul>
<form class="d-flex" method="get" action="/${cur}:search">
<input class="form-control me-2" name="q" type="search" placeholder="Search" aria-label="Search" value="${search_text}" required>
<button class="btn ${UI.search_button_class}" onclick="if($('#search_bar_form>input').val()) $('#search_bar_form').submit();" type="submit">Search</button>
</form>
</div>
</div>
</nav>
`;

    // Personal or team
    if (model.root_type < 2) {
        // Show search box
        html += search_bar;
    }

    $('#nav').html(html);
}

// Sleep Function to Retry API Calls
function sleep(milliseconds) {
    const date = Date.now();
    let currentDate = null;
    do {
        currentDate = Date.now();
    } while (currentDate - date < milliseconds);
}

/**
 * Initiate POST request for listing
 * @param path Path
 * @param params Form params
 * @param resultCallback Success Result Callback
 * @param authErrorCallback Pass Error Callback
 */
function requestListPath(path, params, resultCallback, authErrorCallback, retries = 3, fallback = false) {
    const requestData = {
        id: params['id'] || '',
        type: 'folder',
        password: params['password'] || '',
        page_token: params['page_token'] || '',
        page_index: params['page_index'] || 0
    };
    $('#update').show();
    document.getElementById('update').innerHTML = `<div class='alert alert-info' role='alert'> Connecting...</div></div></div>`;
    if (fallback) {
        path = "/0:fallback";
    }

    function performRequest() {
        fetch(fallback ? "/0:fallback" : path, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            })
            .then(function(response) {
                if (!response.ok) {
                    throw new Error('Request failed');
                }
                return response.json();
            })
            .then(function(res) {
                if (res && res.error && res.error.code === 401) {
                    // Password verification failed
                    askPassword(path);
                } else if (res && res.data === null) {
                    document.getElementById('spinner').remove();
                    document.getElementById('list').innerHTML = `<div class='alert alert-danger' role='alert'> Server didn't send any data.</div></div></div>`;
                    $('#update').hide();
                } else if (res && res.data) {
                    resultCallback(res, path, requestData);
                    $('#update').hide();
                }
            })
            .catch(function(error) {
                if (retries > 0) {
                    sleep(2000);
                    document.getElementById('update').innerHTML = `<div class='alert alert-info' role='alert'> Retrying...</div></div></div>`;
                    performRequest(path, requestData, resultCallback, authErrorCallback, retries - 1);
                } else {
                    document.getElementById('update').innerHTML = `<div class='alert alert-danger' role='alert'> Unable to get data from the server. Something went wrong.</div></div></div>`;
                    document.getElementById('list').innerHTML = `<div class='alert alert-danger' role='alert'> We were unable to get data from the server. ` + error + `</div></div></div>`;
                    $('#update').hide();
                }
            });
    }
    console.log("Performing Request again");
    performRequest();
}




/**
 * Search POST request
 * @param params Form params
 * @param resultCallback Success callback
 */
function requestSearch(params, resultCallback, retries = 3) {
    const p = {
        q: params['q'] || null,
        page_token: params['page_token'] || null,
        page_index: params['page_index'] || 0
    };

    function performRequest(retries) {
        fetch(`/${window.current_drive_order}:search`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(p)
            })
            .then(function(response) {
                if (!response.ok) {
                    throw new Error('Request failed');
                }
                return response.json();
            })
            .then(function(res) {
                if (res && res.data === null) {
                    $('#spinner').remove();
                    $('#list').html(`<div class='alert alert-danger' role='alert'> Server didn't send any data.</div></div></div>`);
                    $('#update').remove();
                }
                if (res && res.data) {
                    if (resultCallback) resultCallback(res, p);
                    $('#update').remove();
                }
            })
            .catch(function(error) {
                if (retries > 0) {
                    sleep(2000);
                    $('#update').html(`<div class='alert alert-info' role='alert'> Retrying...</div></div></div>`);
                    performRequest(retries - 1);
                } else {
                    $('#update').html(`<div class='alert alert-danger' role='alert'> Unable to get data from the server. Something went wrong. 3 Failures</div></div></div>`);
                    $('#list').html(`<div class='alert alert-danger' role='alert'> We were unable to get data from the server.</div></div></div>`);
                    $('#spinner').remove();
                }
            });
    }

    $('#update').html(`<div class='alert alert-info' role='alert'> Connecting...</div></div></div>`);
    performRequest(retries);
}


// Render file list
function list(path, id = '', fallback = false) {
    console.log(id);
    let containerContent = `<div class="container">${UI.fixed_header ?'<br>': ''}
    <div id="update"></div>
    <div id="head_md" style="display:none; padding: 20px 20px;"></div>
    <div class="container" id="select_items" style="padding: 0px 50px 10px; display:none;">
      <div class="d-flex align-items-center justify-content-between">
        <div class="form-check mr-3">
          <input class="form-check-input" style="margin-top: 0.3em;margin-right: 0.5em;" type="checkbox" id="select-all-checkboxes">
          <label class="form-check-label" for="select-all-checkboxes">Select all</label>
        </div>
        <button id="handle-multiple-items-copy" style="padding: 5px 10px; font-size: 12px;" class="btn btn-success">Copy</button>
      </div>
    </div>
    <div class="${UI.path_nav_alert_class} d-flex align-items-center" role="alert" style="margin-bottom: 0; padding-bottom: 0rem;">
      <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
        <ol class="breadcrumb" id="folderne">
          <li class="breadcrumb-item"><a href="/">Home</a></li>`;

    const navfulllink = window.location.pathname;
    const navarray = navfulllink.trim('/').split('/');
    let currentPath = '/';

    if (navarray.length > 1) {
        for (const i in navarray) {
            const pathPart = navarray[i];
            const decodedPathPart = decodeURIComponent(pathPart).replace(/\//g, '%2F');
            const trimmedPathPart = decodedPathPart.replace(/\?.+/g, "$'");

            const displayedPathPart = trimmedPathPart.length > 15 ? trimmedPathPart.slice(0, 5) + '...' : trimmedPathPart.slice(0, 15);

            currentPath += pathPart + '/';

            if (displayedPathPart === '') {
                break;
            }

            containerContent += `<li class="breadcrumb-item"><a href="${currentPath}">${displayedPathPart}</a></li>`;
        }
    }

    containerContent += `</ol>
    </nav>
  </div>
  <div id="list" class="list-group text-break"></div>
  <div class="${UI.file_count_alert_class} text-center d-none" role="alert" id="count"><span class="number text-center"></span> | <span class="totalsize text-center"></span></div>
  <div id="readme_md" style="display:none; padding: 20px 20px;"></div>
</div>`;

    $('#content').html(containerContent);

    const password = localStorage.getItem('password' + path);

    $('#list').html(`<div class="d-flex justify-content-center"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div></div>`);
    $('#readme_md').hide().html('');
    $('#head_md').hide().html('');

    function handleSuccessResult(res, path, prevReqParams) {
        console.log(res, path, prevReqParams);
        $('#list')
            .data('nextPageToken', res['nextPageToken'])
            .data('curPageIndex', res['curPageIndex']);

        $('#spinner').remove();

        if (res['nextPageToken'] === null) {
            $(window).off('scroll');
            window.scroll_status.event_bound = false;
            window.scroll_status.loading_lock = false;
            if (fallback) {
                append_files_to_fallback_list(path, res['data']['files']);
            } else {
                append_files_to_list(path, res['data']['files']);
            }
        } else {
            console.log('doing something...');
            if (fallback) {
                append_files_to_fallback_list(path, res['data']['files']);
            } else {
                append_files_to_list(path, res['data']['files']);
            }
            if (window.scroll_status.event_bound !== true) {
                $(window).on('scroll', function() {
                    const scrollTop = $(this).scrollTop();
                    const scrollHeight = getDocumentHeight();
                    const windowHeight = $(this).height();

                    if (scrollTop + windowHeight > scrollHeight - (Os.isMobile ? 130 : 80)) {
                        if (window.scroll_status.loading_lock === true) {
                            return;
                        }

                        window.scroll_status.loading_lock = true;

                        $(`<div id="spinner" class="d-flex justify-content-center"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div></div>`)
                            .insertBefore('#readme_md');

                        const $list = $('#list');
                        if (fallback) {
                            console.log('fallback inside handleSuccessResult');
                            requestListPath(path, {
                                    id: id,
                                    password: prevReqParams['password'],
                                    page_token: $list.data('nextPageToken'),
                                    page_index: $list.data('curPageIndex') + 1
                                },
                                handleSuccessResult,
                                null, 5, id, fallback = true);
                        } else {
                            requestListPath(path, {
                                    password: prevReqParams['password'],
                                    page_token: $list.data('nextPageToken'),
                                    page_index: $list.data('curPageIndex') + 1
                                },
                                handleSuccessResult,
                                null);
                        }
                    }
                });

                window.scroll_status.event_bound = true;
            }
        }

        if (window.scroll_status.loading_lock === true) {
            window.scroll_status.loading_lock = false;
        }
    }

    if (fallback) {
        console.log('fallback inside list');
        requestListPath(path, {
                id: id,
                password: password
            },
            handleSuccessResult,
            null, null, fallback = true);
    } else {
        console.log("handling this");
        requestListPath(path, {
                password: password
            },
            handleSuccessResult,
            null);
    }


    const copyBtn = document.getElementById("handle-multiple-items-copy");

    // Add a click event listener to the copy button
    copyBtn.addEventListener("click", () => {
        // Get all the checked checkboxes
        const checkedItems = document.querySelectorAll('input[type="checkbox"]:checked');

        // Create an array to store the selected items' data
        const selectedItemsData = [];

        // Loop through each checked checkbox
        if (checkedItems.length === 0) {
            alert("No items selected!");
            return;
        }
        checkedItems.forEach((item) => {
            // Get the value of the checkbox (in this case, the URL)
            const itemData = item.value;
            // Push the value to the array
            selectedItemsData.push(itemData);
        });

        // Join the selected items' data with a newline character
        const dataToCopy = selectedItemsData.join("\n");

        // Create a temporary input element
        const tempInput = document.createElement("textarea");
        tempInput.value = dataToCopy;

        // Add the temporary input element to the document
        document.body.appendChild(tempInput);

        // Select the text inside the temporary input element
        tempInput.select();

        // Copy the selected text to the clipboard
        document.execCommand("copy");

        // Remove the temporary input element from the document
        document.body.removeChild(tempInput);

        // Alert the user that the data has been copied
        alert("Selected items copied to clipboard!");
    });
}

function askPassword(path) {
    $('#spinner').remove();
    const passwordInput = prompt("Directory encryption, please enter the password", "");
    localStorage.setItem('password' + path, passwordInput);

    if (passwordInput != null && passwordInput != "") {
        list(path);
    } else {
        history.go(-1);
    }
}

/**
 * Append the data of the requested new page to the list
 * @param path
 * @param files request result
 */
function append_files_to_fallback_list(path, files) {
    try {
        console.log('append_files_to_fallback_list');
        const $list = $('#list');
        // Is it the last page of data?
        const is_lastpage_loaded = null === $list.data('nextPageToken');
        const is_firstpage = '0' == $list.data('curPageIndex');

        let html = "";
        const targetFiles = [];
        let totalsize = 0;
        let is_file = false;
        for (const i in files) {
            const item = files[i];
            const p = "/fallback?id=" + item.id;
            item['modifiedTime'] = utc2delhi(item['modifiedTime']);
            // replace / with %2F
            if (item['mimeType'] == 'application/vnd.google-apps.folder') {
                html += `<a href="${p}" style="color: ${UI.folder_text_color};" class="countitems list-group-item list-group-item-action"> ${folder_icon} ${item.name} ${UI.display_time ? `<span class="badge bg-info float-end"> ` + item['modifiedTime'] + ` </span>` : ``}</a>`;
            } else {
                totalsize = totalsize + Number(item.size);
                item['size'] = formatFileSize(item['size']);
                is_file = true;
                const epn = item.name;
                const link = UI.second_domain_for_dl ? UI.downloaddomain + item.link : window.location.origin + item.link;
                let pn = path + epn.replace(new RegExp('#', 'g'), '%23').replace(new RegExp('\\?', 'g'), '%3F');
                let c = "file";
                // README is displayed after the last page is loaded, otherwise it will affect the scroll event
                if (is_lastpage_loaded && item.name == "README.md" && UI.render_readme_md) {
                    get_file(p, item, function(data) {
                        markdown("#readme_md", data);
                        $("img").addClass("img-fluid");
                    });
                }
                if (item.name == "HEAD.md" && UI.render_head_md) {
                    get_file(p, item, function(data) {
                        markdown("#head_md", data);
                        $("img").addClass("img-fluid");
                    });
                }
                const ext = item.fileExtension;
                //if ("|html|php|css|go|java|js|json|txt|sh|md|mp4|webm|avi|bmp|jpg|jpeg|png|gif|m4a|mp3|flac|wav|ogg|mpg|mpeg|mkv|rm|rmvb|mov|wmv|asf|ts|flv|pdf|".indexOf(`|${ext}|`) >= 0) {
                //targetFiles.push(filepath);
                pn += "?a=view";
                c += " view";
                //}
                html += `<div class="list-group-item list-group-item-action">${UI.allow_selecting_files ? '<input class="form-check-input" style="margin-top: 0.3em;margin-right: 0.5em;" type="checkbox" value="'+link+'" id="flexCheckDefault">' : ''}`;

                // Use centralized getFileIcon helper
                html += getFileIcon(ext);

                html += ` <a class="countitems size_items list-group-item-action" style="text-decoration: none; color: ${UI.css_a_tag_color};" href="${p}&a=view">${item.name}</a>${UI.display_download ? `<a href="${link}"><svg class="float-end"width="25px" style="margin-left: 8px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"> <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path> <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path> </svg></a>` : ``}${UI.display_size ? `<span class="badge bg-primary float-end"> ` + item['size'] + ` </span>` : ``}${UI.display_time ? ` <span class="badge bg-info float-end"> ` + item['modifiedTime'] + ` </span>` : ``}</div>`;
            }
        }
        if (is_file && UI.allow_selecting_files) {
            document.getElementById('select_items').style.display = 'block';
        }


        /*let targetObj = {};
        targetFiles.forEach((myFilepath, myIndex) => {
            if (!targetObj[myFilepath]) {
                targetObj[myFilepath] = {
                    filepath: myFilepath,
                    prev: myIndex === 0 ? null : targetFiles[myIndex - 1],
                    next: myIndex === targetFiles.length - 1 ? null : targetFiles[myIndex + 1],
                }
            }
        })
        // console.log(targetObj)
        if (Object.keys(targetObj).length) {
            localStorage.setItem(path, JSON.stringify(targetObj));
            // console.log(path)
        }*/

        if (targetFiles.length > 0) {
            const old = localStorage.getItem(path);
            let new_children = targetFiles;
            // Reset on page 1; otherwise append
            if (!is_firstpage && old) {
                let old_children;
                try {
                    old_children = JSON.parse(old);
                    if (!Array.isArray(old_children)) {
                        old_children = [];
                    }
                } catch (e) {
                    old_children = [];
                }
                new_children = old_children.concat(targetFiles);
            }

            localStorage.setItem(path, JSON.stringify(new_children));
        }

        // When it is page 1, remove the horizontal loading bar
        $list.html(($list.data('curPageIndex') == '0' ? '' : $list.html()) + html);
        // When it is the last page, count and display the total number of items
        if (is_lastpage_loaded) {
            const total_size = formatFileSize(totalsize) || '0 Bytes';
            const total_items = $list.find('.countitems').length;
            const total_files = $list.find('.size_items').length;
            if (total_items == 0) {
                $('#count').removeClass('d-none').find('.number').text("Empty Folder");
            } else if (total_items == 1) {
                $('#count').removeClass('d-none').find('.number').text(total_items + " item");
            } else {
                $('#count').removeClass('d-none').find('.number').text(total_items + " items");
            }
            if (total_files == 0) {
                $('#count').removeClass('d-none').find('.totalsize').text("Zero Files");
            } else if (total_files == 1) {
                $('#count').removeClass('d-none').find('.totalsize').text(total_files + " File with Size " + total_size);
            } else {
                $('#count').removeClass('d-none').find('.totalsize').text(total_files + " Files with Size " + total_size);
            }
        }
    } catch (e) {
        console.log(e);
    }
}

/**
 * Append the data of the requested new page to the list
 * @param path
 * @param files request result
 */
function append_files_to_list(path, files) {
    const $list = $('#list');
    // Is it the last page of data?
    const is_lastpage_loaded = null === $list.data('nextPageToken');
    const is_firstpage = '0' == $list.data('curPageIndex');

    let html = "";
    const targetFiles = [];
    let totalsize = 0;
    let is_file = false;
    for (const i in files) {
        const item = files[i];
        const ep = encodeURIComponent(item.name).replace(/\//g, '%2F') + '/';
        const p = path + ep.replace(new RegExp('#', 'g'), '%23').replace(new RegExp('\\?', 'g'), '%3F');
        item['modifiedTime'] = utc2delhi(item['modifiedTime']);
        // replace / with %2F
        if (item['mimeType'] == 'application/vnd.google-apps.folder') {
            html += `<a href="${p}" style="color: ${UI.folder_text_color};" class="countitems list-group-item list-group-item-action"> ${folder_icon} ${item.name} ${UI.display_time ? `<span class="badge bg-info float-end"> ` + item['modifiedTime'] + ` </span>` : ``}</a>`;
        } else {
            totalsize = totalsize + Number(item.size);
            item['size'] = formatFileSize(item['size']);
            is_file = true;
            const epn = item.name;
            const link = UI.second_domain_for_dl ? UI.downloaddomain + item.link : window.location.origin + item.link;
            let pn = path + epn.replace(new RegExp('#', 'g'), '%23').replace(new RegExp('\\?', 'g'), '%3F');
            let c = "file";
            // README is displayed after the last page is loaded, otherwise it will affect the scroll event
            if (is_lastpage_loaded && item.name == "README.md" && UI.render_readme_md) {
                get_file(p, item, function(data) {
                    markdown("#readme_md", data);
                    $("img").addClass("img-fluid");
                });
            }
            if (item.name == "HEAD.md" && UI.render_head_md) {
                get_file(p, item, function(data) {
                    markdown("#head_md", data);
                    $("img").addClass("img-fluid");
                });
            }
            const ext = item.fileExtension;
            console.log(ext);
            //if ("|html|php|css|go|java|js|json|txt|sh|md|mp4|webm|avi|bmp|jpg|jpeg|png|gif|m4a|mp3|flac|wav|ogg|mpg|mpeg|mkv|rm|rmvb|mov|wmv|asf|ts|flv|pdf|".indexOf(`|${ext}|`) >= 0) {
            //targetFiles.push(filepath);
            pn += "?a=view";
            c += " view";
            //}
            html += `<div class="list-group-item list-group-item-action">${UI.allow_selecting_files ? '<input class="form-check-input" style="margin-top: 0.3em;margin-right: 0.5em;" type="checkbox" value="'+link+'" id="flexCheckDefault">' : ''}`;

            // Use centralized getFileIcon helper
            html += getFileIcon(ext);

            html += ` <a class="countitems size_items list-group-item-action" style="text-decoration: none; color: ${UI.css_a_tag_color};" href="${pn}">${item.name}</a>${UI.display_download ? `<a href="${link}"><svg class="float-end"width="25px" style="margin-left: 8px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"> <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path> <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path> </svg></a>` : ``}${UI.display_size ? `<span class="badge bg-primary float-end"> ` + item['size'] + ` </span>` : ``}${UI.display_time ? ` <span class="badge bg-info float-end"> ` + item['modifiedTime'] + ` </span>` : ``}</div>`;
        }
    }
    if (is_file && UI.allow_selecting_files) {
        document.getElementById('select_items').style.display = 'block';
    }


    /*let targetObj = {};
    targetFiles.forEach((myFilepath, myIndex) => {
        if (!targetObj[myFilepath]) {
            targetObj[myFilepath] = {
                filepath: myFilepath,
                prev: myIndex === 0 ? null : targetFiles[myIndex - 1],
                next: myIndex === targetFiles.length - 1 ? null : targetFiles[myIndex + 1],
            }
        }
    })
    // console.log(targetObj)
    if (Object.keys(targetObj).length) {
        localStorage.setItem(path, JSON.stringify(targetObj));
        // console.log(path)
    }*/

    if (targetFiles.length > 0) {
        const old = localStorage.getItem(path);
        let new_children = targetFiles;
        // Reset on page 1; otherwise append
        if (!is_firstpage && old) {
            let old_children;
            try {
                old_children = JSON.parse(old);
                if (!Array.isArray(old_children)) {
                    old_children = [];
                }
            } catch (e) {
                old_children = [];
            }
            new_children = old_children.concat(targetFiles);
        }

        localStorage.setItem(path, JSON.stringify(new_children));
    }

    // When it is page 1, remove the horizontal loading bar
    $list.html(($list.data('curPageIndex') == '0' ? '' : $list.html()) + html);
    // When it is the last page, count and display the total number of items
    if (is_lastpage_loaded) {
        const total_size = formatFileSize(totalsize) || '0 Bytes';
        const total_items = $list.find('.countitems').length;
        const total_files = $list.find('.size_items').length;
        if (total_items == 0) {
            $('#count').removeClass('d-none').find('.number').text("Empty Folder");
        } else if (total_items == 1) {
            $('#count').removeClass('d-none').find('.number').text(total_items + " item");
        } else {
            $('#count').removeClass('d-none').find('.number').text(total_items + " items");
        }
        if (total_files == 0) {
            $('#count').removeClass('d-none').find('.totalsize').text("Zero Files");
        } else if (total_files == 1) {
            $('#count').removeClass('d-none').find('.totalsize').text(total_files + " File with Size " + total_size);
        } else {
            $('#count').removeClass('d-none').find('.totalsize').text(total_files + " Files with Size " + total_size);
        }
    }
}

/**
 * Render the search results list. There is a lot of repetitive code, but there are different logics in it.
 */
function render_search_result_list() {
    const content = `
  <div class="container"><br>
  <div id="update"></div>
  <div class="container" id="select_items" style="padding: 0px 50px 10px; display:none;">
  <div class="d-flex align-items-center justify-content-between">
    <div class="form-check mr-3">
      <input class="form-check-input" style="margin-top: 0.3em;margin-right: 0.5em;" type="checkbox" id="select-all-checkboxes">
      <label class="form-check-label" for="select-all-checkboxes">Select all</label>
    </div>
    <button id="handle-multiple-items-copy" style="padding: 5px 10px; font-size: 12px;" class="btn btn-success">Copy</button>
  </div>
  </div>
  <div class="card">
  <div class="${UI.path_nav_alert_class} d-flex align-items-center" role="alert" style="margin-bottom: 0;">Search Results</div>
  <div id="list" class="list-group text-break">
  </div>
  </div>
  <div class="${UI.file_count_alert_class} text-center d-none" role="alert" id="count"><span class="number text-center"></span> | <span class="totalsize text-center"></span></div>
  <div id="readme_md" style="display:none; padding: 20px 20px;"></div>
  </div>
  `;
    $('#content').html(content);

    $('#list').html(`<div class="d-flex justify-content-center"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div></div>`);
    $('#readme_md').hide().html('');
    $('#head_md').hide().html('');

    /**
     * Callback after successful search request returns data
     * The result returned by @param res (object)
     * @param path the requested path
     * @param prevReqParams parameters used in request
     */
    function searchSuccessCallback(res, prevReqParams) {

        // Temporarily store nextPageToken and currentPageIndex in the list element
        $('#list')
            .data('nextPageToken', res['nextPageToken'])
            .data('curPageIndex', res['curPageIndex']);

        // Remove loading spinner
        $('#spinner').remove();

        if (res['nextPageToken'] === null) {
            // If it is the last page, unbind the scroll event, reset scroll_status, and append the data
            $(window).off('scroll');
            window.scroll_status.event_bound = false;
            window.scroll_status.loading_lock = false;
            append_search_result_to_list(res['data']['files']);
        } else {
            // If it is not the last page, append data and bind the scroll event (if not already bound), update scroll_status
            append_search_result_to_list(res['data']['files']);
            if (window.scroll_status.event_bound !== true) {
                // Bind event, if not yet bound
                $(window).on('scroll', function() {
                    const scrollTop = $(this).scrollTop();
                    const scrollHeight = getDocumentHeight();
                    const windowHeight = $(this).height();
                    // Roll to the bottom
                    if (scrollTop + windowHeight > scrollHeight - (Os.isMobile ? 130 : 80)) {
                        /*
     When the event of scrolling to the bottom is triggered, if it is already loading at this time, the event is ignored;
                 Otherwise, go to loading and occupy the loading lock, indicating that loading is in progress
             */
                        if (window.scroll_status.loading_lock === true) {
                            return;
                        }
                        window.scroll_status.loading_lock = true;

                        // Show a loading spinner
                        $(`<div id="spinner" class="d-flex justify-content-center"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div></div>`)
                            .insertBefore('#readme_md');

                        const $list = $('#list');
                        requestSearch({
                                q: window.MODEL.q,
                                page_token: $list.data('nextPageToken'),
                                // Request next page
                                page_index: $list.data('curPageIndex') + 1
                            },
                            searchSuccessCallback
                        );
                    }
                });
                window.scroll_status.event_bound = true;
            }
        }

        // After loading successfully and rendering new data successfully, release the loading lock so that you can continue to process the "scroll to bottom" event
        if (window.scroll_status.loading_lock === true) {
            window.scroll_status.loading_lock = false;
        }
    }

    // Start requesting data from page 1
    requestSearch({
        q: window.MODEL.q
    }, searchSuccessCallback);

    const copyBtn = document.getElementById("handle-multiple-items-copy");

    // Add a click event listener to the copy button
    copyBtn.addEventListener("click", () => {
        // Get all the checked checkboxes
        const checkedItems = document.querySelectorAll('input[type="checkbox"]:checked');

        // Create an array to store the selected items' data
        const selectedItemsData = [];
        if (checkedItems.length === 0) {
            alert("No items selected!");
            return;
        }
        // Loop through each checked checkbox
        checkedItems.forEach((item) => {
            // Get the value of the checkbox (in this case, the URL)
            const itemData = item.value;
            // Push the value to the array
            selectedItemsData.push(itemData);
        });

        // Join the selected items' data with a newline character
        const dataToCopy = selectedItemsData.join("\n");

        // Create a temporary input element
        const tempInput = document.createElement("textarea");
        tempInput.value = dataToCopy;

        // Add the temporary input element to the document
        document.body.appendChild(tempInput);

        // Select the text inside the temporary input element
        tempInput.select();

        // Copy the selected text to the clipboard
        document.execCommand("copy");

        // Remove the temporary input element from the document
        document.body.removeChild(tempInput);

        // Alert the user that the data has been copied
        alert("Selected items copied to clipboard!");
    });
}

/**
 * Append a new page of search results
 * @param files
 */
function append_search_result_to_list(files) {
    try {
        const cur = window.current_drive_order || 0;
        const $list = $('#list');
        // Is it the last page of data?
        const is_lastpage_loaded = null === $list.data('nextPageToken');
        // var is_firstpage = '0' == $list.data('curPageIndex');

        let html = "";
        let totalsize = 0;
        let is_file = false;
        for (const i in files) {
            const item = files[i];
            if (item['size'] == undefined) {
                item['size'] = "";
            }

            item['modifiedTime'] = utc2delhi(item['modifiedTime']);
            if (item['mimeType'] == 'application/vnd.google-apps.folder') {
                html += `<a style="color: ${UI.folder_text_color};" onclick="onSearchResultItemClick('${item['id']}', false)" data-bs-toggle="modal" data-bs-target="#SearchModel" class="countitems list-group-item list-group-item-action"> ${folder_icon} ${item.name} ${UI.display_time ? `<span class="badge bg-info float-end"> ` + item['modifiedTime'] + ` </span>` : ``}</a>`;
            } else {
                is_file = true;
                totalsize = totalsize + Number(item.size);
                item['size'] = formatFileSize(item['size']);
                const ext = item.fileExtension;
                const link = UI.second_domain_for_dl ? UI.downloaddomain + item.link : window.location.origin + item.link;
                html += `<div style="color: ${UI.css_a_tag_color};" gd-type="$item['mimeType']}" class="countitems size_items list-group-item list-group-item-action">${UI.allow_selecting_files ? '<input class="form-check-input" style="margin-top: 0.3em;margin-right: 0.5em;" type="checkbox" value="'+link+'" id="flexCheckDefault">' : ''}`;

                // Use centralized getFileIcon helper
                html += getFileIcon(ext);

                html += ` <span onclick="onSearchResultItemClick('${item['id']}', true)" data-bs-toggle="modal" data-bs-target="#SearchModel">${item.name}</span>${UI.display_download ? `<a href="${link}"><svg class="float-end"width="25px" style="margin-left: 8px;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"> <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path> <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path> </svg></a>` : ``}<span class="badge float-end csize"> ${UI.display_size ? `<span class="badge bg-primary float-end"> ` + item['size'] + ` </span>` : ``}${UI.display_time ? ` <span class="badge bg-info float-end"> ` + item['modifiedTime'] + ` </span>` : ``}</div>`;

            }
        }
        if (is_file && UI.allow_selecting_files) {
            document.getElementById('select_items').style.display = 'block';
        }
        // When it is page 1, remove the horizontal loading bar
        $list.html(($list.data('curPageIndex') == '0' ? '' : $list.html()) + html);
        // When it is the last page, count and display the total number of items
        if (is_lastpage_loaded) {
            const total_size = formatFileSize(totalsize) || '0 Bytes';
            const total_items = $list.find('.countitems').length;
            const total_files = $list.find('.size_items').length;
            if (total_items == 0) {
                $('#count').removeClass('d-none').find('.number').text("No Results");
            } else if (total_items == 1) {
                $('#count').removeClass('d-none').find('.number').text(total_items + " item");
            } else {
                $('#count').removeClass('d-none').find('.number').text(total_items + " items");
            }
            if (total_files == 0) {
                $('#count').removeClass('d-none').find('.totalsize').text("Found Nothing");
            } else if (total_files == 1) {
                $('#count').removeClass('d-none').find('.totalsize').text(total_files + " File with Size " + total_size);
            } else {
                $('#count').removeClass('d-none').find('.totalsize').text(total_files + " Files with Size " + total_size);
            }
        }
    } catch (e) {
        console.log(e);
    }
}

/**
 * Search result item click event
 * @param a_ele Clicked element
 */
function onSearchResultItemClick(file_id, can_preview) {
    const cur = window.current_drive_order;
    let title = `Loading...`;
    $('#SearchModelLabel').html(title);
    let content = `<div class="d-flex justify-content-center"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div>`;
    $('#modal-body-space').html(content);
    const p = {
        id: file_id
    };
    // Request a path
    fetch(`/${cur}:id2path`, {
            method: 'POST',
            body: JSON.stringify(p),
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            }
        })
        .then(function(response) {
            if (response.ok) {
                return response.json();
            } else {
                throw new Error('Request failed.');
            }
        })
        .then(function(obj) {
            const href = `${obj.path}`;
            const encodedUrl = href.replace(new RegExp('#', 'g'), '%23').replace(new RegExp('\\?', 'g'), '%3F');
            title = `Result`;
            $('#SearchModelLabel').html(title);
            content = `<a class="btn btn-info" href="${encodedUrl}${can_preview ? '?a=view' : ''}">Open</a> <a class="btn btn-secondary" href="${encodedUrl}${can_preview ? '?a=view' : ''}" target="_blank">Open in New Tab</a>`;
            $('#modal-body-space').html(content);
        })
        .catch(function(error) {
            console.log(error);
            const link = "";
            title = `Fallback Method`;
            $('#SearchModelLabel').html(title);
            content = `<a class="btn btn-info" href="/fallback?id=${file_id}&${can_preview ? 'a=view' : ''}">Open</a> <a class="btn btn-secondary" href="/fallback?id=${file_id}&${can_preview ? 'a=view' : ''}" target="_blank">Open in New Tab</a>`;
            $('#modal-body-space').html(content);
        });
}

function get_file(path, file, callback) {
    const key = "file_path_" + path + file['modifiedTime'];
    const data = localStorage.getItem(key);
    if (data != undefined) {
        return callback(data);
    } else {
        $.get(path, function(d) {
            localStorage.setItem(key, d);
            callback(d);
        });
    }
}

async function fallback(id, type) {
    if (type) { // is a file id
        const cookie_folder_id = await getCookie("root_id") || '';
        $('#content').html(`<div class="d-flex justify-content-center" style="height: 150px"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div></div>`);
        fetch("/0:fallback", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    id
                }),
            })
            .then(function(response) {
                if (!response.ok) {
                    throw new Error("Request failed");
                }
                return response.json();
            })
            .then(function(obj) {
                console.log(obj);
                const mimeType = obj.mimeType;
                const fileExtension = obj.fileExtension;
                const code = ["php", "css", "go", "java", "js", "json", "txt", "sh", "md", "html", "xml", "py", "rb", "c", "cpp", "h", "hpp"];
                const video = ["mp4", "webm", "avi", "mpg", "mpeg", "mkv", "rm", "rmvb", "mov", "wmv", "asf", "ts", "flv", "3gp", "m4v"];
                const audio = ["mp3", "flac", "wav", "ogg", "m4a", "aac", "wma", "alac"];
                const image = ["bmp", "jpg", "jpeg", "png", "gif", "svg", "tiff", "ico"];
                const pdf = ["pdf"];
								const dwg = ["dwg", "dxf"];
                if (mimeType === "application/vnd.google-apps.folder") {
                    window.location.href = window.location.pathname + "/";
                } else if (fileExtension) {
                    const name = obj.name;
                    const encoded_name = encodeURIComponent(name);
                    const size = formatFileSize(obj.size);
                    const url = UI.second_domain_for_dl ? UI.downloaddomain + obj.link : window.location.origin + obj.link;
                    const file_id = obj.id;
                    if (mimeType.includes("video") || video.includes(fileExtension)) {
                        const poster = obj.thumbnailLink ? obj.thumbnailLink.replace("s220", "s0") : UI.poster;
                        file_video(name, encoded_name, size, poster, url, mimeType, file_id, cookie_folder_id);
                    } else if (mimeType.includes("audio") || audio.includes(fileExtension)) {
                        file_audio(name, encoded_name, size, url, file_id, cookie_folder_id);
										} else if (
											mimeType.startsWith("image/") &&
											!mimeType.includes("dwg") &&
											!mimeType.includes("dxf") ||
											image.includes(fileExtension)
										) {
										//} else if (mimeType.includes("image") || image.includes(fileExtension)) {
                        file_image(name, encoded_name, size, url, file_id, cookie_folder_id);
                    } else if (mimeType.includes("pdf") || pdf.includes(fileExtension)) {
                        file_pdf(name, encoded_name, size, url, file_id, cookie_folder_id);
										} else if (mimeType.includes("dwg") || dwg.includes(fileExtension)) {
                        file_dwg(name, encoded_name, size, url, file_id, cookie_folder_id);
                    } else if (code.includes(fileExtension)) {
                        file_code(name, encoded_name, size, url, file_id, cookie_folder_id);
                    } else {
                        file_others(name, encoded_name, size, url, file_id, cookie_folder_id);
                    }
                }
            })
            .catch(function(error) {
                const content = `
          <div class="container"><br>
          <div class="card text-center">
            <div class="card-body text-center">
              <div class="${UI.file_view_alert_class}" id="file_details" role="alert"><b>404.</b> That’s an error. ` + error + `</div>
            </div>
            <p>The requested URL was not found on this server. That’s all we know.</p>
            <div class="card-text text-center">
              <div class="btn-group text-center">
                <a href="/" type="button" class="btn btn-primary">Homepage</a>
              </div>
            </div><br>
          </div>
        </div>`;
                $("#content").html(content);
            });
    } else { // is a folder id
        return list(id, true);
    }
}

// File display ?a=view
async function file(path) {
    const cookie_folder_id = await getCookie("root_id") || '';
    const name = path.split('/').pop();
    $('#content').html(`<div class="d-flex justify-content-center" style="height: 150px"><div class="spinner-border ${UI.loading_spinner_class} m-5" role="status" id="spinner"><span class="sr-only"></span></div></div>`);
    fetch("", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                path: path
            }),
        })
        .then(function(response) {
            if (!response.ok) {
                throw new Error("Request failed");
            }
            return response.json();
        })
        .then(function(obj) {
            console.log(obj);
            const mimeType = obj.mimeType;
            const fileExtension = obj.fileExtension;
            const code = ["php", "css", "go", "java", "js", "json", "txt", "sh", "md", "html", "xml", "py", "rb", "c", "cpp", "h", "hpp"];
            const video = ["mp4", "webm", "avi", "mpg", "mpeg", "mkv", "rm", "rmvb", "mov", "wmv", "asf", "ts", "flv", "3gp", "m4v"];
            const audio = ["mp3", "flac", "wav", "ogg", "m4a", "aac", "wma", "alac"];
            const image = ["bmp", "jpg", "jpeg", "png", "gif", "svg", "tiff", "ico"];
            const pdf = ["pdf"];
						const dwg = ["dwg", "dxf"];
            if (mimeType === "application/vnd.google-apps.folder") {
                window.location.href = window.location.pathname + "/";
            } else if (fileExtension) {
                const name = obj.name;
                const encoded_name = encodeURIComponent(name);
                const size = formatFileSize(obj.size);
                const url = UI.second_domain_for_dl ? UI.downloaddomain + obj.link : window.location.origin + obj.link;
                const file_id = obj.id;
                if (mimeType.includes("video") || video.includes(fileExtension)) {
                    const poster = obj.thumbnailLink ? obj.thumbnailLink.replace("s220", "s0") : UI.poster;
                    file_video(name, encoded_name, size, poster, url, mimeType, file_id, cookie_folder_id);
                } else if (mimeType.includes("audio") || audio.includes(fileExtension)) {
                    file_audio(name, encoded_name, size, url, file_id, cookie_folder_id);
								} else if (
									mimeType.startsWith("image/") &&
									!mimeType.includes("dwg") &&
									!mimeType.includes("dxf") ||
									image.includes(fileExtension)
								) {
                //} else if (mimeType.includes("image") || image.includes(fileExtension)) {
                    file_image(name, encoded_name, size, url, file_id, cookie_folder_id);
                } else if (mimeType.includes("pdf") || pdf.includes(fileExtension)) {
                    file_pdf(name, encoded_name, size, url, file_id, cookie_folder_id);
								} else if (mimeType.includes("dwg") || dwg.includes(fileExtension)) {
                    file_dwg(name, encoded_name, size, url, file_id, cookie_folder_id);
                } else if (code.includes(fileExtension)) {
                    file_code(name, encoded_name, size, url, file_id, cookie_folder_id);
                } else {
                    file_others(name, encoded_name, size, url, file_id, cookie_folder_id);
                }
								//alert(mimeType);
            }
        })
        .catch(function(error) {
            const content = `
          <div class="container"><br>
          <div class="card text-center">
            <div class="card-body text-center">
              <div class="${UI.file_view_alert_class}" id="file_details" role="alert"><b>404.</b> That’s an error. ` + error + `</div>
            </div>
            <p>The requested URL was not found on this server. That’s all we know.</p>
            <div class="card-text text-center">
              <div class="btn-group text-center">
                <a href="/" type="button" class="btn btn-primary">Homepage</a>
              </div>
            </div><br>
          </div>
        </div>`;
            $("#content").html(content);
        });
}
// Document display |zip|.exe/others direct downloads
function file_others(name, encoded_name, size, url, file_id, cookie_folder_id) {
    // Split the file path into parts
    const path = window.location.pathname;
    const pathParts = path.split('/');
    // Generate the navigation based on path parts
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i == pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part == '') {
            part = 'Home';
        }
        navigation += '<a href="' + new_path + '" class="breadcrumb-item">' + part + '</a>';
    }

    // Add the container and card elements
    const content = `
    <div class="container"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>
            <div class="card text-center">
            <div class="card-body text-center">
              <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>
            </div>
            <div class="card-body">
            <div class="input-group mb-4">
              <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
            </div>
            <div class="card-text text-center">
            <div class="btn-group text-center">
                <a href="${url}" type="button" class="btn btn-primary">Download</a>
                <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <span class="sr-only"></span>
                </button>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
                  <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
                  <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
                </div>
            </div>
            </div>
            <br></div>`;
    $("#content").html(content);
}

function file_code(name, encoded_name, size, bytes, url, ext, file_id, cookie_folder_id) {
    const type = {
        "html": "html",
        "php": "php",
        "css": "css",
        "go": "golang",
        "java": "java",
        "js": "javascript",
        "json": "json",
        "txt": "Text",
        "sh": "sh",
        "md": "Markdown",
    };

    // Split the file path into parts
    const path = window.location.pathname;
    const pathParts = path.split('/');
    // Generate the navigation based on path parts
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i == pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part == '') {
            part = 'Home';
        }
        navigation += '<a href="' + new_path + '" class="breadcrumb-item">' + part + '</a>';
    }

    // Add the container and card elements
    const content = `
    <div class="container"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>
      <div class="card text-center">
        <div class="card-body text-center">
          <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>
        </div>
        <div id="code_spinner"></div>` +
        (UI.second_domain_for_dl ? `` : `<pre class="line-numbers language-markup" data-src="plugins/line-numbers/index.html" data-start="-5" style="white-space: pre-wrap; counter-reset: linenumber -6;" data-src-status="loaded" tabindex="0"><code id="editor"></code></pre>`) +
        `<div class="card-body">
          <div class="input-group mb-4">
            <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
          </div>
          <div class="card-text text-center">
            <div class="btn-group text-center">
              <a href="${url}" type="button" class="btn btn-primary">Download</a>
              <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="sr-only"></span>
              </button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
              </div>
            </div>
          </div>
          <br>
        </div>
      </div>
    </div>`;

    $('#content').html(content);
    const spinner = '<div class="d-flex justify-content-center"><div class="spinner-border m-5" role="status"><span class="sr-only"></span></div></div>';
    $("#code_spinner").html(spinner);
    if (bytes <= 1024 * 1024 * 2) {
        $.get(url, function(data) {
            $('#editor').html($('<div/>').text(data).html());
            $("#code_spinner").html("");
            let code_type = "Text";
            if (type[ext] != undefined) {
                code_type = type[ext];
            }
        });
    } else {
        $("#code_spinner").html("");
        $('#editor').html(`<div class="${UI.file_view_alert_class}" id="file_details" role="alert">File size is too large to preview, Max Limit is 2 MB</div>`);
    }
}



// Document display video |mp4|webm|avi|
function file_video(name, encoded_name, size, poster, url, mimeType, file_id, cookie_folder_id) {
    const url_base64 = btoa(url);
    // Split the file path into parts
    const path = window.location.pathname;
    const pathParts = path.split('/');
    // Generate the navigation based on path parts
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i == pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part == '') {
            part = 'Home';
        }
        navigation += '<a href="' + new_path + '" class="breadcrumb-item">' + part + '</a>';
    }
    let player;
    let player_js = '';
    let player_css = '';
    if (!UI.disable_player) {
        if (player_config.player == "plyr") {
            player = `<video id="player" playsinline controls data-poster="${poster}">
      <source src="${url}" type="video/mp4" />
      <source src="${url}" type="video/webm" />
        </video>`;
            player_js = 'https://cdn.plyr.io/' + player_config.plyr_io_version + '/plyr.polyfilled.js';
            player_css = 'https://cdn.plyr.io/' + player_config.plyr_io_version + '/plyr.css';
        } else if (player_config.player == "videojs") {
            player = `<video id="vplayer" poster="${poster}" muted=true class="video-js vjs-default-skin" controls preload="auto" width="100%" height="100%" data-setup='{"fluid": true}' style="--plyr-captions-text-color: #ffffff;--plyr-captions-background: #000000;">
      <source src="${url}" type="video/mp4" />
      <source src="${url}" type="video/webm" />
      <source src="${url}" type="video/avi" />
    </video>`;
            player_js = 'https://vjs.zencdn.net/' + player_config.videojs_version + '/video.js';
            player_css = 'https://vjs.zencdn.net/' + player_config.videojs_version + '/video-js.css';
        } else if (player_config.player == "dplayer") {
            player = `<div id="player-container"></div>`;
            player_js = 'https://cdn.jsdelivr.net/npm/dplayer/dist/DPlayer.min.js';
            player_css = 'https://cdn.jsdelivr.net/npm/dplayer/dist/DPlayer.min.css';
        } else if (player_config.player == "jwplayer") {
            player = `<div id="player"></div>`;
            player_js = 'https://content.jwplatform.com/libraries/IDzF9Zmk.js';
            player_css = '';
        }
    }
    // Add the container and card elements
    const content = `
    <div class="container text-center"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>
      <div class="card text-center">
        <div class="text-center">
          <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>${player}</div>
        </br>
        ${UI.disable_video_download ? `` : `
          <div class="card-body">
          <div class="input-group mb-4">
          <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
          </div>
          <div class="btn-group text-center">
              <a href="${url}" type="button" class="btn btn-primary">Download</a>
              <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="sr-only"></span>
              </button>
              <div class="dropdown-menu">
              <a class="dropdown-item" href="iina://weblink?url=${url}">IINA</a>
              <a class="dropdown-item" href="potplayer://${url}">PotPlayer</a>
              <a class="dropdown-item" href="vlc://${url}">VLC Mobile</a>
              <a class="dropdown-item" href="${url}">VLC Desktop</a>
              <a class="dropdown-item" href="nplayer-${url}">nPlayer</a>
              <a class="dropdown-item" href="intent://${url}#Intent;type=video/any;package=is.xyz.mpv;scheme=https;end;">mpv-android</a>
              <a class="dropdown-item" href="mpv://${url_base64}">mpv x64</a>
              <a class="dropdown-item" href="intent:${url}#Intent;package=com.mxtech.videoplayer.ad;S.title=${encoded_name};end">MX Player (Free)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;package=com.mxtech.videoplayer.pro;S.title=${encoded_name};end">MX Player (Pro)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
              </div>
          </div>
          </div>
          </div>
          `}
      </div>
    </div>
  `;
    $("#content").html(content);

    // Load Video.js and initialize the player
    const videoJsScript = document.createElement('script');
    videoJsScript.src = player_js;
    videoJsScript.onload = function() {
        // Video.js is loaded, initialize the player
        if (player_config.player == "plyr") {
            const player = new Plyr('#player');
        } else if (player_config.player == "videojs") {
            const player = new videojs('vplayer');
        } else if (player_config.player == "dplayer") {
            const dp = new DPlayer({
                container: document.getElementById('player-container'),
                screenshot: true,
                video: {
                    url: url,
                    pic: poster,
                    thumbnails: poster,
                },
            });
        } else if (player_config.player == "jwplayer") {
            jwplayer("player").setup({
                file: url,
                type: mimeType,
                autostart: false,
                image: poster,
                width: "100%",
                aspectratio: "16:9",
                title: name,
                description: "Powered by Google Drive Index",
                tracks: [{
                    file: url,
                    kind: "captions",
                    label: "Default",
                    "default": true,
                }],
                captions: {
                    color: "#f3f378",
                    fontSize: 14,
                    backgroundOpacity: 50,
                    edgeStyle: "raised",
                },
            });
        }

    };
    document.head.appendChild(videoJsScript);

    const videoJsStylesheet = document.createElement('link');
    videoJsStylesheet.href = player_css;
    videoJsStylesheet.rel = 'stylesheet';
    document.head.appendChild(videoJsStylesheet);
}


// File display Audio |mp3|flac|m4a|wav|ogg|
function file_audio(name, encoded_name, size, url, file_id, cookie_folder_id) {
    const url_base64 = btoa(url);
    // Split the file path into parts
    const path = window.location.pathname;
    const pathParts = path.split('/');
    // Generate the navigation based on path parts
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i == pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part == '') {
            part = 'Home';
        }
        navigation += '<a href="' + new_path + '" class="breadcrumb-item">' + part + '</a>';
    }

    // Add the container and card elements
    const content = `
    <div class="container text-center"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>
      <div class="card text-center">
        <div class="text-center">
          <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>
          ${UI.disable_player ? `` : `
          <video id="aplayer" poster="${UI.audioposter}" muted=true class="video-js vjs-default-skin" controls preload="auto" width="100%" height="100%" data-setup='{"fluid": true}' style="--plyr-captions-text-color: #ffffff;--plyr-captions-background: #000000;">
            <source src="${url}" type="audio/mpeg" />
            <source src="${url}" type="audio/ogg" />
            <source src="${url}" type="audio/wav" />
          </video>`}
        </div>
        </br>
        ${UI.disable_audio_download ? `` : `
          <div class="card-body">
          <div class="input-group mb-4">
          <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
          </div>
          <div class="btn-group text-center">
              <a href="${url}" type="button" class="btn btn-primary">Download</a>
              <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="sr-only"></span>
              </button>
              <div class="dropdown-menu">
              <a class="dropdown-item" href="iina://weblink?url=${url}">IINA</a>
              <a class="dropdown-item" href="potplayer://${url}">PotPlayer</a>
              <a class="dropdown-item" href="vlc://${url}">VLC Mobile</a>
              <a class="dropdown-item" href="${url}">VLC Desktop</a>
              <a class="dropdown-item" href="nplayer-${url}">nPlayer</a>
              <a class="dropdown-item" href="intent://${url}#Intent;type=audio/any;package=is.xyz.mpv;scheme=https;end;">mpv-android</a>
              <a class="dropdown-item" href="mpv://${url_base64}">mpv x64</a>
              <a class="dropdown-item" href="intent:${url}#Intent;package=com.mxtech.videoplayer.ad;S.title=${encoded_name};end">MX Player (Free)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;package=com.mxtech.videoplayer.pro;S.title=${encoded_name};end">MX Player (Pro)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
              <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
              </div>
          </div>
          <br>
          </div>
          </div>
          `}
      </div>
    </div>
  `;
    $("#content").html(content);

    // Load Video.js and initialize the player
    const videoJsScript = document.createElement('script');
    videoJsScript.src = 'https://vjs.zencdn.net/' + UI.videojs_version + '/video.min.js';
    videoJsScript.onload = function() {
        // Video.js is loaded, initialize the player
        const player = videojs('aplayer');
    };
    document.head.appendChild(videoJsScript);

    const videoJsStylesheet = document.createElement('link');
    videoJsStylesheet.href = 'https://vjs.zencdn.net/' + UI.videojs_version + '/video-js.css';
    videoJsStylesheet.rel = 'stylesheet';
    document.head.appendChild(videoJsStylesheet);
}



// Document display pdf
function file_pdf(name, encoded_name, size, url, file_id, cookie_folder_id) {
    // Split the file path into parts
    const path = window.location.pathname;
    const pathParts = path.split('/');
    // Generate the navigation based on path parts
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i == pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part == '') {
            part = 'Home';
        }
        navigation += '<a href="' + new_path + '" class="breadcrumb-item">' + part + '</a>';
    }

    // Add the container and card elements
    const content = `
    <div class="container text-center"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>
    <div class="card">
    <div class="card-body text-center">
    <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>
    <div>
    </div><br>
    <iframe src="https://docs.google.com/gview?url=${encodeURIComponent(url)}&embedded=true" style="width:100%; height:500px;" frameborder="0"></iframe>
    </div>
    <div class="card-body">
    <div class="input-group mb-4">
    <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
    </div>
    <div class="card-text text-center">
    <div class="btn-group text-center">
        <a href="${url}" type="button" class="btn btn-primary">Download</a>
        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="sr-only"></span>
        </button>
        <div class="dropdown-menu">
            <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
            <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
            <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
        </div>
    </div>
    </div>
    <br>

    </div>
    </div>
    </div>
  `;
    $("#content").html(content);
}


// image display
function file_image(name, encoded_name, size, url, file_id, cookie_folder_id) {
    // Split the file path into parts
    const path = window.location.pathname;
    const pathParts = path.split('/');
    // Generate the navigation based on path parts
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i == pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part == '') {
            part = 'Home';
        }
        navigation += '<a href="' + new_path + '" class="breadcrumb-item">' + part + '</a>';
    }

    // Add the container and card elements // wait until image is loaded and then hide spinner
    const content = `
    <div class="container text-center"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>
      <div class="card">
        <div class="card-body text-center">
          <div class="${UI.file_view_alert_class}" id="file_details" role="alert">${name}<br>${size}</div>
          <img src="${url}" id="load_image" width="100%">
        </div>
        <div class="card-body">
          <div class="input-group mb-4">
            <div class="input-group-prepend">
              <span class="input-group-text" id="">Full URL</span>
            </div>
            <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
          </div>
          <div class="card-text text-center">
            <div class="btn-group text-center">
              <a href="${url}" type="button" class="btn btn-primary">Download</a>
              <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="sr-only"></span>
              </button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
              </div>
            </div>
          </div>
          <br>
        </div>
      </div>
    </div>
  `;
    $('#content').html(content);
}

// Document display dwg
function file_dwg(name, encoded_name, size, url, file_id, cookie_folder_id) {
    const path = window.location.pathname;
    const pathParts = path.split('/');
    let navigation = '';
    let new_path = '';
    for (let i = 0; i < pathParts.length; i++) {
        let part = pathParts[i];
        if (i === pathParts.length - 1) {
            new_path += part + '?a=view';
        } else {
            new_path += part + '/';
        }
        if (part.length > 15) {
            part = decodeURIComponent(part);
            part = part.substring(0, 10) + '...';
        }
        if (part === '') {
            part = 'Home';
        }
        navigation += `<a href="${new_path}" class="breadcrumb-item">${part}</a>`;
    }
		alert(new_path);
    let viewerUrl = `https://sharecad.org/cadframe/load?url=${encodeURIComponent(url)}`;
    const content = `
    <div class="container text-center"><br>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          ${navigation}
        </ol>
      </nav>

      <div class="card">
        <div class="card-body text-center">
          <div class="${UI.file_view_alert_class}" id="file_details" role="alert">
            ${name}<br>${size}<br>
            <small>(Đang tải viewer CAD từ ShareCAD...)</small>
          </div>

          <div id="cad-viewer-container" style="width:100%; height:70vh; min-height:500px; border:1px solid #ccc; position:relative;">
            <div id="cad-loading" style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background:#f8f9fa;">
              Đang tải file DWG...
            </div>
          </div>
        </div>

        <!-- Giữ phần download như cũ -->
        <div class="card-body">
          <div class="input-group mb-4">
            <div class="input-group-prepend">
              <span class="input-group-text">Full URL</span>
            </div>
            <input type="text" class="form-control" id="dlurl" value="${url}" readonly>
          </div>

          <div class="card-text text-center">
            <div class="btn-group text-center">
              <a href="${url}" type="button" class="btn btn-primary">Download</a>
              <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown">
                <span class="sr-only"></span>
              </button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Free)</a>
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.adm.lite/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM (Lite)</a>
                <a class="dropdown-item" href="intent:${url}#Intent;component=idm.internet.download.manager.plus/idm.internet.download.manager.Downloader;S.title=${encoded_name};end">1DM+ (Plus)</a>
              </div>
            </div>
          </div>
          <br>
        </div>
      </div>

      <!-- Script nhúng iframe client-side -->
      <script>
        (function() {
          const container = document.getElementById('cad-viewer-container');
          const loading = document.getElementById('cad-loading');

          const iframe = document.createElement('iframe');
          iframe.src = "${viewerUrl}";
          iframe.style.cssText = 'width:100%; height:100%; border:none;';
          iframe.allow = 'fullscreen';
          iframe.allowFullscreen = true;

          iframe.onload = () => {
            loading.style.display = 'none';
          };

          iframe.onerror = () => {
            loading.innerHTML = 'Không tải được viewer. Có thể file quá lớn hoặc ShareCAD tạm lỗi.<br>Kiểm tra console trình duyệt.';
            loading.style.color = 'red';
          };

          container.appendChild(iframe);
        })();
      </script>
    </div>
    `;

    $('#content').html(content);
}

// Time conversion
function utc2delhi(utc_datetime) {
    // Convert UTC datetime to local Delhi time
    const utcDate = new Date(utc_datetime);
    const delhiDate = new Date(utcDate.getTime() + 5.5 * 60 * 60 * 1000);

    // Format the Delhi date and time
    const year = delhiDate.getFullYear();
    const month = ('0' + (delhiDate.getMonth() + 1)).slice(-2);
    const date = ('0' + delhiDate.getDate()).slice(-2);
    const hour = ('0' + delhiDate.getHours()).slice(-2);
    const minute = ('0' + delhiDate.getMinutes()).slice(-2);
    const second = ('0' + delhiDate.getSeconds()).slice(-2);

    return `${date}-${month}-${year} ${hour}:${minute}:${second}`;
}


// bytes adaptive conversion to KB, MB, GB
function formatFileSize(bytes) {
    if (bytes >= 1099511627776) {
        bytes = (bytes / 1099511627776).toFixed(2) + ' TB';
    } else if (bytes >= 1073741824) {
        bytes = (bytes / 1073741824).toFixed(2) + ' GB';
    } else if (bytes >= 1048576) {
        bytes = (bytes / 1048576).toFixed(2) + ' MB';
    } else if (bytes >= 1024) {
        bytes = (bytes / 1024).toFixed(2) + ' KB';
    } else if (bytes > 1) {
        bytes = bytes + ' bytes';
    } else if (bytes === 1) {
        bytes = bytes + ' byte';
    } else {
        bytes = '';
    }
    return bytes;
}


String.prototype.trim = function(char) {
    if (char) {
        return this.replace(new RegExp('^\\' + char + '+|\\' + char + '+$', 'g'), '');
    }
    return this.replace(/^\s+|\s+$/g, '');
};


// README.md HEAD.md support
function markdown(el, data) {
    const html = marked.parse(data);
    $(el).show().html(html);
}

// Listen for fallback events
window.onpopstate = function() {
    const path = window.location.pathname;
    render(path);
};

$(function() {
    init();
    const path = window.location.pathname;
    /*$("body").on("click", '.folder', function () {
        var url = $(this).attr('href');
        history.pushState(null, null, url);
        render(url);
        return false;
    });
    $("body").on("click", '.view', function () {
        var url = $(this).attr('href');
        history.pushState(null, null, url);
        render(url);
        return false;
    });*/

    render(path);
});

// Copy to Clipboard for Direct Links, This will be modified soon with other UI
function copyFunction() {
    const copyText = document.getElementById("dlurl");
    copyText.select();
    copyText.setSelectionRange(0, 99999);

    navigator.clipboard.writeText(copyText.value)
        .then(function() {
            const tooltip = document.getElementById("myTooltip");
            tooltip.innerHTML = "Copied";
        })
        .catch(function(error) {
            console.error("Failed to copy text: ", error);
        });
}

function outFunc() {
    const tooltip = document.getElementById("myTooltip");
    tooltip.innerHTML = "Copy";
}

// function to update the list of checkboxes
function updateCheckboxes() {
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    const selectAllCheckbox = document.getElementById('select-all-checkboxes');

    if (checkboxes.length > 0 && selectAllCheckbox) { // Check if checkboxes and selectAllCheckbox exist
        selectAllCheckbox.addEventListener('click', () => {
            checkboxes.forEach((checkbox) => {
                checkbox.checked = selectAllCheckbox.checked;
            });
        });
    }
}

async function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

// Copy File to User Drive
async function copyFile(driveid) {
    try {
        const copystatus = document.getElementById('copystatus');
        copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> Processing... </div>`;

        const user_folder_id = document.getElementById('user_folder_id').value;
        if (user_folder_id === '') {
            copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> Empty ID </div>`;
            return null;
        }

        document.getElementById('spinner').style.display = 'block';
        document.cookie = `root_id=${user_folder_id}; expires=Thu, 18 Dec 2050 12:00:00 UTC`;
        const time = Math.floor(Date.now() / 1000);
        const response = await fetch('/copy', {
            method: 'POST',
            cache: 'no-cache',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: `id=${encodeURIComponent(driveid)}&root_id=${user_folder_id}&resourcekey=null&time=${time}`
        });

        if (response.status === 500) {
            copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> Unable to Copy File, Make Sure you've added system@zindex.eu.org to your Destination Folder </div>`;
        } else if (response.status === 401) {
            copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> Unauthorized </div>`;
        } else if (response.ok) {
            const data = await response.json();
            if (data && data.name) {
                const link = `https://drive.google.com/file/d/${data.id}/view?usp=share_link`;
                const copyresult = document.getElementById('copyresult');
                copyresult.innerHTML = `<div class="col-12 col-md-12"> <input type="text" id="usercopiedfile" class="form-control" placeholder="Enter Your Folder ID to Copy this File" value="${link}" readonly></div> <div class="col-12 col-md-12"> <a href="${link}" target="_blank" style="margin-top: 5px;" class="btn btn-danger btn-block">Open Copied File</a></div>`;
            } else if (data && data.error && data.error.message) {
                copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> ` + data.error.message + ` </div>`;
            } else {
                copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> Unable to Copy File </div>`;
            }
        } else {
            copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> Unable to Copy File </div>`;
        }

        document.getElementById('spinner').style.display = 'none';
    } catch (error) {
        const copystatus = document.getElementById('copystatus');
        copystatus.innerHTML = `<div class='alert alert-danger' role='alert'> An error occurred ` + error + `</div>`;
        document.getElementById('spinner').style.display = 'none';
    }
}


// create a MutationObserver to listen for changes to the DOM
const observer = new MutationObserver(() => {
    updateCheckboxes();
});

// define the options for the observer (listen for changes to child elements)
const options = {
    childList: true,
    subtree: true
};

// observe changes to the body element
observer.observe(document.documentElement, options);
